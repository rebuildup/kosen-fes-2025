import{a as D,l as I,c as K,r as c,m as T,E as R,D as k,j as e,n as L,u as O,b as q,o as W,e as G,f as V,s as X,k as Y}from"./index-C4BiSv4v.js";import{T as Z}from"./TagFilter-CoIbOSyp.js";import{C as _,a as C}from"./CardListToggle-CiRFMm8q.js";import{p as ee}from"./random-DoZnV0pN.js";import"./UnifiedCard-BGvCktGd.js";const se=({autoFocus:o=!1,className:r="",placeholder:g,showSuggestions:s=!1,variant:i="default"})=>{const{t:l}=D(),{performSearch:x,recentSearches:y,searchQuery:t,setSearchQuery:j}=I(),f=K(),[p,d]=c.useState(t),[h,u]=c.useState(!1),[m,v]=c.useState(-1),N=c.useRef(null),w=c.useRef(null),S=c.useRef(null),F=c.useRef(null);c.useEffect(()=>{o&&N.current&&N.current.focus()},[o]),c.useEffect(()=>{d(t)},[t]),c.useEffect(()=>{w.current&&(h?T.to(w.current,{borderColor:"var(--primary-color)",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.1)",duration:k.FAST,ease:R.SMOOTH}):T.to(w.current,{borderColor:"var(--border-color)",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.05)",duration:k.FAST,ease:R.SMOOTH}))},[h]),c.useEffect(()=>{S.current&&(h?T.fromTo(S.current,{autoAlpha:0,y:-10},{autoAlpha:1,duration:k.FAST,ease:R.SMOOTH,y:0}):T.to(S.current,{autoAlpha:0,duration:k.FAST,ease:R.SMOOTH,y:-10}))},[h]);const Q=a=>{const n=a.target.value;d(n),j(n),v(-1),s&&n.trim()?u(!0):u(!1)},A=a=>{a.preventDefault(),p.trim()&&(x(p.trim()),f(`/search?q=${encodeURIComponent(p.trim())}`),u(!1))},$=a=>{d(a),j(a),x(a),f(`/search?q=${encodeURIComponent(a)}`),u(!1)},U=a=>{if(!h)return;const n=y;switch(a.key){case"ArrowDown":{a.preventDefault(),v(b=>b<n.length-1?b+1:b);break}case"ArrowUp":{a.preventDefault(),v(b=>b>0?b-1:b);break}case"Enter":{a.preventDefault(),m>=0&&n[m]?$(n[m]):A(a);break}case"Escape":{u(!1),v(-1);break}}},z=()=>{s&&p.trim()&&u(!0)},B=a=>{setTimeout(()=>{var n;!((n=F.current)!=null&&n.contains(a.relatedTarget))&&a.relatedTarget!==N.current&&(u(!1),v(-1))},150)},P=()=>{d(""),j(""),u(!1),N.current&&N.current.focus()},H=()=>{const a=`
      w-full pl-12 border transition-all duration-200 focus:outline-none focus:ring-2
      bg-[var(--bg-primary)] border-[var(--border-color)] text-[var(--text-primary)]
      placeholder-[var(--text-secondary)] focus:border-[var(--primary-color)] 
      focus:ring-[var(--primary-color)]/20
    `,n=p.trim()?"pr-32":"pr-20";switch(i){case"large":return`${a} ${n} py-4 text-lg rounded-full focus:ring-4`;case"inline":return`${a} ${n} py-2 text-sm rounded-full`;default:return`${a} ${n} py-3 text-base rounded-full`}},J=()=>{switch(i){case"large":return 24;case"inline":return 16;default:return 20}},M=s?y:[];return e.jsxs("div",{className:`relative w-full ${r}`,children:[e.jsx("form",{ref:w,onSubmit:A,className:"relative w-full",children:e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute top-1/2 left-4 z-10 -translate-y-1/2 transform",children:e.jsx(L,{size:J(),className:"text-[var(--text-secondary)]"})}),e.jsx("input",{ref:N,type:"text",value:p,onChange:Q,onKeyDown:U,onFocus:z,onBlur:B,placeholder:g||l("search.placeholder"),className:H(),autoComplete:"off",role:"searchbox","aria-label":l("search.placeholder"),"aria-expanded":h,"aria-haspopup":"listbox"}),p.trim()&&e.jsx("button",{type:"button",onClick:P,className:"absolute top-1/2 right-20 -translate-y-1/2 transform rounded-full p-1 text-[var(--text-secondary)] transition-all duration-200 hover:bg-[var(--bg-secondary)] hover:text-[var(--text-primary)]","aria-label":l("actions.clear"),children:e.jsx("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),e.jsx("button",{type:"submit",className:"absolute top-1/2 right-2 -translate-y-1/2 transform rounded-full bg-[var(--primary-color)] px-4 py-2 font-medium text-white transition-all duration-200 hover:scale-105 hover:bg-[var(--primary-color)]/90 hover:shadow-lg focus:ring-2 focus:ring-[var(--primary-color)]/20 focus:outline-none active:scale-95","aria-label":l("actions.search"),children:l("actions.search")})]})}),h&&M.length>0&&e.jsx("div",{ref:F,className:"absolute top-full right-0 left-0 z-50 mt-2 max-h-64 overflow-y-auto rounded-lg border border-[var(--border-color)] bg-[var(--bg-primary)] shadow-lg",children:e.jsx("div",{ref:S,className:"py-2",role:"listbox","aria-label":l("search.suggestions"),children:M.map((a,n)=>e.jsxs("button",{onClick:()=>$(a),className:`flex w-full items-center gap-3 px-4 py-3 text-left transition-all duration-200 ${m===n?"bg-[var(--bg-tertiary)] text-[var(--primary-color)]":"text-[var(--text-primary)] hover:bg-[var(--bg-secondary)]"}`,role:"option","aria-selected":m===n,children:[e.jsx(L,{size:16,className:"text-[var(--text-secondary)]"}),e.jsx("span",{className:"flex-1",children:a}),e.jsx("span",{className:"text-xs text-[var(--text-secondary)]",children:l("search.recentSearches")})]},n))})})]})};function E(o,r){if(!r.trim()||!o)return e.jsx(e.Fragment,{children:o});try{const g=o.split(new RegExp(`(${r})`,"gi"));return e.jsx(e.Fragment,{children:g.map((s,i)=>s.toLowerCase()===r.toLowerCase()?e.jsx("mark",{className:"rounded bg-gradient-to-r from-[var(--accent-yellow)] to-[var(--accent-orange)] px-1 text-[var(--text-primary)]",children:s},i):s)})}catch(g){return console.error("Error highlighting text:",g),e.jsx(e.Fragment,{children:o})}}const re=()=>{const{isSearching:o,searchQuery:r,searchResults:g}=I(),{t:s}=D(),{selectedTags:i}=O(),{filterByTags:l}=q(),[x,y]=c.useState("default"),[t,j]=c.useState({events:[],exhibits:[],stalls:[]}),f=c.useCallback(d=>i.length===0?d:d.filter(h=>i.every(u=>{var m;return(m=h.tags)==null?void 0:m.includes(u)})),[i]);c.useEffect(()=>{const d=r.trim();let h=g;d||(h=i.length>0?l(i):[]);const u=i.length>0?f(h):h,m={events:[],exhibits:[],stalls:[]};for(const v of u)switch(v.type){case"event":{m.events.push(v);break}case"exhibit":{m.exhibits.push(v);break}case"stall":{m.stalls.push(v);break}}j(m)},[g,f,i,r,l]);const p=t.events.length+t.exhibits.length+t.stalls.length;return o?e.jsxs("div",{className:"py-12 text-center",children:[e.jsx("div",{className:"mx-auto mb-4 h-8 w-8 animate-spin rounded-full border-4 border-[var(--primary-color)] border-t-transparent"}),e.jsx("span",{className:"text-[var(--text-secondary)]",children:s("search.searching")})]}):!r&&i.length===0?e.jsx("div",{className:"py-12 text-center text-[var(--text-secondary)]",children:e.jsx("p",{children:s("search.searchPrompt")})}):p===0?e.jsxs("div",{className:"py-12 text-center",children:[e.jsx("h2",{className:"mb-2 text-xl font-semibold text-[var(--text-primary)]",children:s("search.noResults")}),e.jsx("p",{className:"text-[var(--text-secondary)]",children:s("search.tryDifferentKeywords")})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col items-start justify-between gap-4 rounded-xl border border-[var(--border-color)] bg-[var(--bg-secondary)] p-6 sm:flex-row sm:items-center",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-[var(--text-primary)]",children:s("search.results")}),p>0&&e.jsxs("span",{className:"rounded-full bg-[var(--primary-color)] px-3 py-1 text-sm font-medium text-white",children:[p," ",s("search.items")]})]}),e.jsx(_,{viewMode:x,setViewMode:y})]}),e.jsxs("div",{className:"space-y-8",children:[t.events.length>0&&e.jsxs("section",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-8 w-1 rounded-full bg-gradient-to-b from-[var(--accent-purple)] to-[var(--accent-pink)]"}),e.jsxs("h3",{className:"text-xl font-semibold text-[var(--text-primary)]",children:["🎭 ",s("navigation.events")]}),e.jsx("div",{className:"h-px flex-1 bg-[var(--border-color)]"}),e.jsxs("span",{className:"rounded-full bg-[var(--bg-secondary)] px-3 py-1 text-sm text-[var(--text-secondary)]",children:[t.events.length," ",s("search.items")]})]}),e.jsx("div",{className:"rounded-xl bg-[var(--bg-secondary)] p-6",children:e.jsx(C,{items:t.events,variant:x,showTags:!0,showDescription:x==="list",highlightText:d=>E(d,r),emptyMessage:s("events.noEventsFound"),filterType:"all"})})]}),t.exhibits.length>0&&e.jsxs("section",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-8 w-1 rounded-full bg-gradient-to-b from-[var(--accent-blue)] to-[var(--accent-teal)]"}),e.jsxs("h3",{className:"text-xl font-semibold text-[var(--text-primary)]",children:["🎨 ",s("exhibits.filters.exhibits")]}),e.jsx("div",{className:"h-px flex-1 bg-[var(--border-color)]"}),e.jsxs("span",{className:"rounded-full bg-[var(--bg-secondary)] px-3 py-1 text-sm text-[var(--text-secondary)]",children:[t.exhibits.length," ",s("search.items")]})]}),e.jsx("div",{className:"rounded-xl bg-[var(--bg-secondary)] p-6",children:e.jsx(C,{items:t.exhibits,variant:x,showTags:!0,showDescription:x==="list",highlightText:d=>E(d,r),emptyMessage:s("exhibits.noExhibits"),filterType:"all"})})]}),t.stalls.length>0&&e.jsxs("section",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-8 w-1 rounded-full bg-gradient-to-b from-[var(--accent-orange)] to-[var(--accent-red)]"}),e.jsxs("h3",{className:"text-xl font-semibold text-[var(--text-primary)]",children:["🍜 ",s("exhibits.filters.stalls")]}),e.jsx("div",{className:"h-px flex-1 bg-[var(--border-color)]"}),e.jsxs("span",{className:"rounded-full bg-[var(--bg-secondary)] px-3 py-1 text-sm text-[var(--text-secondary)]",children:[t.stalls.length," ",s("search.items")]})]}),e.jsx("div",{className:"rounded-xl bg-[var(--bg-secondary)] p-6",children:e.jsx(C,{items:t.stalls,variant:x,showTags:!0,showDescription:x==="list",highlightText:d=>E(d,r),emptyMessage:s("exhibits.noStalls"),filterType:"all"})})]})]})]})},ae=G,te=V,le=Y,ne=X,ce=o=>o.replace(/^\.?\/?images\//,"./images/");function oe(){const o=[...ae.map(r=>r.imageUrl),...te.map(r=>r.imageUrl),...ne.map(r=>r.imageUrl),...le.map(r=>r.imageUrl)].filter(Boolean).map(ce);return ee(o)||""}const ue=()=>{const{performSearch:o,searchQuery:r,searchResults:g,setSearchQuery:s}=I(),{selectedTags:i}=O(),{t:l}=D(),x=W(),y=c.useMemo(()=>oe(),[]),t=r.trim().length>0||i.length>0||g.length>0;return c.useEffect(()=>{const f=new URLSearchParams(x.search).get("q");f&&f!==r&&(s(f),o(f))},[x.search,r,s,o]),e.jsxs("div",{className:"min-h-screen bg-[var(--bg-primary)]",children:[e.jsxs("section",{className:"relative overflow-hidden py-16",children:[e.jsx("img",{src:y,className:"pointer-events-none absolute inset-0 z-0 h-full w-full object-cover opacity-20",alt:"","aria-hidden":"true"}),e.jsx("div",{className:"absolute inset-0 opacity-10",style:{background:"var(--instagram-gradient)"}}),e.jsx("div",{className:"relative mx-auto max-w-7xl px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"text-center",children:[!t&&e.jsxs(e.Fragment,{children:[e.jsx("h1",{className:"mb-4 text-4xl font-bold text-[var(--text-primary)] md:text-5xl",children:l("search.title")}),e.jsx("p",{className:"mx-auto mb-8 max-w-2xl text-xl text-[var(--text-secondary)]",children:l("search.subtitle")})]}),e.jsx("div",{className:"mx-auto max-w-3xl",children:e.jsx(se,{variant:"large",autoFocus:!0,showSuggestions:!0})}),!t&&e.jsx("div",{className:"mx-auto mt-6 max-w-2xl",children:e.jsxs("div",{className:"rounded-xl border border-[var(--border-color)] bg-[var(--bg-secondary)] p-4",children:[e.jsxs("h3",{className:"mb-3 flex items-center justify-center gap-2 text-sm font-semibold text-[var(--text-primary)]",children:[e.jsx("span",{children:"💡"}),l("search.searchTips")]}),e.jsxs("div",{className:"space-y-2 text-sm text-[var(--text-secondary)]",children:[e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-[var(--primary-color)]",children:"•"}),e.jsx("span",{children:l("search.searchInstructions.keyword")})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-[var(--primary-color)]",children:"•"}),e.jsx("span",{children:l("search.searchInstructions.tags")})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-[var(--primary-color)]",children:"•"}),e.jsx("span",{children:l("search.searchInstructions.location")})]})]})]})}),e.jsx("div",{className:"mx-auto mt-6 max-w-3xl",children:e.jsx(Z,{compact:!1})})]})})]}),e.jsx("section",{className:"section bg-[var(--bg-primary)]",children:e.jsx("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8",children:e.jsx("div",{className:"space-y-8",children:e.jsx("div",{className:"rounded-xl bg-[var(--bg-primary)]",children:e.jsx(re,{})})})})})]})};export{ue as default};
