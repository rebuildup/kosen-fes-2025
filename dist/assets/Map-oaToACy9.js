import{a as b,j as e,S as C,I as L,u as k,r as o,e as S,f as M,s as I}from"./index-BiXXeQ0D.js";import{V as T}from"./VectorMap-BOTJFS-V.js";import{U as H,a as E}from"./UnifiedCard-DLtq07NS.js";import{T as z}from"./TagFilter-BVafVQ93.js";import{S as A}from"./SelectedTags-D5kIVGup.js";const U=({locations:n,getItemsForLocation:i,hoveredLocation:v,selectedLocation:g,onLocationHover:p,onLocationSelect:f})=>{const{t:u}=b(),x=[...n].sort((l,t)=>{const r=i(l).length,a=i(t).length;return r!==a?a-r:l.localeCompare(t)});return e.jsxs("div",{className:"rounded-lg p-6 bg-white/10 border border-white/20",style:{backgroundColor:"var(--color-bg-secondary)"},children:[e.jsxs("h2",{className:"text-xl font-semibold mb-6 flex items-center gap-2",style:{color:"var(--color-text-primary)"},children:[u("map.viewLocations")," (",x.length,")"]}),x.length===0?e.jsx("div",{className:"text-center py-8",style:{color:"var(--color-text-secondary)"},children:u("map.noLocations")}):e.jsx("div",{className:"overflow-x-auto scrollbar-thin",children:e.jsx("div",{className:"flex gap-4 pb-4",style:{minWidth:"max-content"},children:x.map(l=>{const t=i(l),r=t[0];return r?e.jsx("div",{className:"flex-shrink-0 w-72",onMouseEnter:()=>p(l),onMouseLeave:()=>p(null),onClick:()=>f(l),children:e.jsxs("div",{className:"relative",children:[e.jsx(H,{item:r,variant:"compact",showTags:!1,showDescription:!1,showAnimation:!0}),e.jsxs("div",{className:"absolute top-2 left-2 bg-black/80 rounded-lg px-3 py-1 text-white",children:[e.jsx("div",{className:"text-sm font-semibold",children:l}),e.jsxs("div",{className:"text-xs opacity-80",children:[t.length," ",(t.length===1,"項目")]})]}),e.jsx("div",{className:"absolute bottom-2 right-2 bg-black/80 rounded-lg px-2 py-1",children:e.jsx("div",{className:"text-xs text-white",children:(()=>{const a=t.filter(c=>c.type==="event").length,d=t.filter(c=>c.type==="exhibit").length,h=t.filter(c=>c.type==="stall").length;return e.jsxs("div",{className:"flex items-center gap-3",children:[a>0&&e.jsxs("div",{className:"flex items-center gap-1","aria-label":`${a} イベント`,children:[e.jsx(C,{size:14}),e.jsx("span",{className:"text-xs text-white",children:a})]}),d>0&&e.jsxs("div",{className:"flex items-center gap-1","aria-label":`${d} 展示`,children:[e.jsx(L,{size:14}),e.jsx("span",{className:"text-xs text-white",children:d})]}),h>0&&e.jsxs("div",{className:"flex items-center gap-1","aria-label":`${h} 出店`,children:[e.jsx(E,{size:14}),e.jsx("span",{className:"text-xs text-white",children:h})]})]})})()})})]})},l):null})})})]})},Z=n=>n.type==="event"||n.type==="exhibit"||n.type==="stall",D=()=>{const{t:n}=b(),{filterItemsByTags:i,selectedTags:v}=k(),g="70vh",[p,f]=o.useState(null),[u,x]=o.useState(null),l=o.useMemo(()=>S.filter(s=>s.showOnMap),[]),t=o.useMemo(()=>[...l,...M,...I],[l]),r=o.useMemo(()=>[...new Set(t.map(s=>s.location))],[t]),a=o.useMemo(()=>v.length===0?t:i(t).filter(Z),[t,v,i]),d=o.useMemo(()=>{const s={};return r.forEach(m=>{const j=a.filter(w=>w.location===m);j.length>0&&(s[m]=j)}),s},[r,a]),h=o.useCallback(s=>{f(s)},[]),c=o.useCallback(s=>{x(m=>s===m?null:s)},[]),y=o.useCallback(s=>a.filter(m=>m.location===s),[a]),N=o.useMemo(()=>Object.keys(d),[d]);return e.jsx("div",{className:"min-h-screen",children:e.jsxs("section",{className:"section py-8",style:{backgroundColor:"var(--color-bg-primary)"},children:[e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsx("div",{className:"mb-8",children:e.jsx("h1",{className:"text-3xl font-bold",style:{color:"var(--color-text-primary)"},children:n("map.title")})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx(z,{compact:!0}),e.jsx(A,{})]}),e.jsx("div",{className:"w-full",children:e.jsxs("div",{className:"rounded-lg overflow-hidden relative",style:{backgroundColor:"var(--color-bg-secondary)"},children:[e.jsx("div",{className:"p-4 border-b",style:{borderColor:"var(--color-border-primary)"},children:e.jsx("h2",{className:"text-xl font-semibold flex items-center gap-2",style:{color:"var(--color-text-primary)"},children:"会場マップ"})}),e.jsx("div",{className:"relative",children:e.jsx("div",{className:"map-container relative m-4",style:{minHeight:g,backgroundColor:"var(--color-bg-secondary)",borderColor:"var(--color-border-primary)"},children:e.jsx(T,{mode:"display",points:a.filter(s=>s.coordinates).map(s=>({id:s.id,coordinates:s.coordinates,title:s.title,type:s.type,isSelected:!1,isHovered:!1,contentItem:s,onClick:()=>{},onHover:()=>{}})),height:g,className:"rounded-lg",maxZoom:8,minZoom:.3,showControls:!0,initialZoom:2})})})]})})]})]}),e.jsx("div",{className:"mt-6",children:e.jsx(U,{locations:N,getItemsForLocation:y,onLocationSelect:c,onLocationHover:h,hoveredLocation:p,selectedLocation:u})})]})})};export{D as default};
