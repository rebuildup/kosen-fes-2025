import{a as e,j as t,u as s,e as o,c as l,s as a}from"./index-70FMaGan.js";import{r as i}from"./react-DptwHfsC.js";import{S as r}from"./SelectedTags-xGVZdVnh.js";import{T as n}from"./TagFilter-B3cDUpIC.js";import{U as c}from"./UnifiedCard-BiDk9nM4.js";import{S as d,I as m,U as x}from"./ui-9eKVU0xZ.js";import{V as h}from"./VectorMap-LHAcH6M5.js";import"./animation-BGH1bKEe.js";const p=({getItemsForLocation:s,hoveredLocation:o,locations:l,onLocationHover:a,onLocationSelect:i,selectedLocation:r})=>{const{t:n}=e(),h=[...l].sort((e,t)=>{const o=s(e).length,l=s(t).length;return o!==l?l-o:e.localeCompare(t)});return t.jsxs("div",{className:"rounded-lg border border-white/20 bg-white/10 p-6",style:{backgroundColor:"var(--color-bg-secondary)"},children:[t.jsxs("h2",{className:"mb-6 flex items-center gap-2 text-xl font-semibold",style:{color:"var(--color-text-primary)"},children:[n("map.viewLocations")," (",h.length,")"]}),0===h.length?t.jsx("div",{className:"py-8 text-center",style:{color:"var(--color-text-secondary)"},children:n("map.noLocations")}):t.jsx("div",{className:"scrollbar-thin overflow-x-auto",children:t.jsx("div",{className:"flex gap-4 pb-4",style:{minWidth:"max-content"},children:h.map(e=>{const o=s(e),l=o[0];return l?t.jsx("button",{type:"button",className:"w-80 flex-shrink-0 text-left",onMouseEnter:()=>a(e),onMouseLeave:()=>a(null),onClick:()=>i(e),children:t.jsxs("div",{className:"relative",children:[t.jsx(c,{item:l,variant:"default",showTags:!1,showDescription:!1,showAnimation:!0}),t.jsxs("div",{className:"absolute top-2 left-2 rounded-lg bg-black/80 px-3 py-1 text-white",children:[t.jsx("div",{className:"text-sm font-semibold",children:e}),t.jsxs("div",{className:"text-xs opacity-80",children:[o.length," ",(o.length,"項目")]})]}),t.jsx("div",{className:"absolute right-2 bottom-2 rounded-lg bg-black/80 px-2 py-1",children:t.jsx("div",{className:"text-xs text-white",children:(()=>{const e=o.filter(e=>"event"===e.type).length,s=o.filter(e=>"exhibit"===e.type).length,l=o.filter(e=>"stall"===e.type).length;return t.jsxs("div",{className:"flex items-center gap-3",children:[e>0&&t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx(d,{size:14}),t.jsx("span",{className:"text-xs text-white",children:e})]}),s>0&&t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx(m,{size:14}),t.jsx("span",{className:"text-xs text-white",children:s})]}),l>0&&t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx(x,{size:14}),t.jsx("span",{className:"text-xs text-white",children:l})]})]})})()})})]})},e):null})})})]})},y=o,v=l,j=a,g=[{id:"toilet-1",name:"経営棟トイレ",type:"toilet",x:400,y:390},{id:"toilet-2",name:"第一体育館トイレ 男",type:"toilet",x:985,y:972},{id:"toilet-2-2",name:"第一体育館トイレ 女",type:"toilet",x:1045,y:972},{id:"toilet-3",name:"学生会館トイレ",type:"toilet",x:590,y:700},{id:"toilet-4",name:"図書館棟トイレ",type:"toilet",x:530,y:560},{id:"toilet-5",name:"一般棟トイレ",type:"toilet",x:730,y:950},{id:"toilet-6",name:"物質棟トイレ",type:"toilet",x:590,y:1090},{id:"trash-1",name:"学生会館 ゴミ箱",type:"trash",x:540,y:700},{id:"trash-2",name:"学生会館 ゴミ箱",type:"trash",x:520,y:826}],u=e=>"event"===e.type||"exhibit"===e.type||"stall"===e.type,b=()=>{const{t:o}=e(),{filterItemsByTags:l,selectedTags:a}=s(),c="70vh",[d,m]=i.useState(null),[x,b]=i.useState(null),f=i.useMemo(()=>y.filter(e=>e.showOnMap),[]),N=i.useMemo(()=>[...f,...v,...j],[f]),w=i.useMemo(()=>[...new Set(N.map(e=>e.location))],[N]),C=i.useMemo(()=>0===a.length?N:l(N).filter(u),[N,a,l]),k=i.useMemo(()=>!(a.length>0),[a]),L=i.useMemo(()=>{const e={};for(const t of w){const s=C.filter(e=>e.location===t);s.length>0&&(e[t]=s)}return e},[w,C]),M=i.useCallback(e=>{m(e)},[]),S=i.useCallback(e=>{b(t=>e===t?null:e)},[]),H=i.useCallback(e=>C.filter(t=>t.location===e),[C]),T=i.useMemo(()=>Object.keys(L),[L]);return t.jsx("div",{className:"min-h-screen",children:t.jsxs("section",{className:"section py-8",style:{backgroundColor:"var(--color-bg-primary)"},children:[t.jsxs("div",{className:"mx-auto max-w-7xl",children:[t.jsx("div",{className:"mb-8",children:t.jsx("h1",{className:"text-3xl font-bold",style:{color:"var(--color-text-primary)"},children:o("map.title")})}),t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"space-y-4",children:[t.jsx(n,{compact:!0}),t.jsx(r,{})]}),t.jsx("div",{className:"w-full",children:t.jsxs("div",{className:"relative overflow-hidden rounded-lg",style:{backgroundColor:"var(--color-bg-secondary)"},children:[t.jsx("div",{className:"border-b p-4",style:{borderColor:"var(--color-border-primary)"},children:t.jsx("h2",{className:"flex items-center gap-2 text-xl font-semibold",style:{color:"var(--color-text-primary)"},children:"会場マップ"})}),t.jsx("div",{className:"relative",children:t.jsx("div",{className:"map-container relative m-4",style:{backgroundColor:"var(--color-bg-secondary)",borderColor:"var(--color-border-primary)",minHeight:c},children:t.jsx(h,{mode:"display",points:[...C.filter(e=>void 0!==e.coordinates).map(e=>({contentItem:e,coordinates:e.coordinates,id:e.id,isHovered:!1,isSelected:!1,onClick:()=>{},onHover:()=>{},title:e.title,type:e.type})),...k?g.map(e=>({coordinates:{x:e.x,y:e.y},id:e.id,isHovered:!1,isSelected:!1,onClick:()=>{},onHover:()=>{},title:"",type:e.type})):[]],height:c,className:"rounded-lg",maxZoom:8,minZoom:.3,showControls:!0,initialZoom:2})})})]})})]})]}),t.jsx("div",{className:"mt-6",children:t.jsx(p,{locations:T,getItemsForLocation:H,onLocationSelect:S,onLocationHover:M,hoveredLocation:d,selectedLocation:x})})]})})};export{b as default};
