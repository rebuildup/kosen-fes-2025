import{g as ft,r as o,j as e,a as Ce,t as Bt,I as Xe,S as Se}from"./index-DokeM4iO.js";import{U as se}from"./UnifiedCard-BvPemLuQ.js";/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Te=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"m21 3-7 7",key:"1l2asr"}],["path",{d:"m3 21 7-7",key:"tjx5ai"}],["path",{d:"M9 21H3v-6",key:"wtvkvv"}]],Ee=ft("maximize-2",Te);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const De=[["path",{d:"m14 10 7-7",key:"oa77jy"}],["path",{d:"M20 10h-6V4",key:"mjg0md"}],["path",{d:"m3 21 7-7",key:"tjx5ai"}],["path",{d:"M4 14h6v6",key:"rmj7iw"}]],Le=ft("minimize-2",De);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Re=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],_e=ft("rotate-ccw",Re);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ae=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],Be=ft("zoom-in",Ae);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ze=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],We=ft("zoom-out",ze);function $e(M){const k=M.split(" ").map(Number);let E=0,R=0,v=0;for(let N=0;N<k.length;N+=2)!Number.isNaN(k[N])&&!Number.isNaN(k[N+1])&&(E+=k[N],R+=k[N+1],v++);return{x:E/v,y:R/v}}const Ie=[{id:"_第二体育館",name:"第二体育館",points:"213.8533 275.8108 133.9082 275.8108 131.9095 283.8053 109.9246 283.8053 109.9246 273.8122 81.9438 273.8122 81.9438 251.8273 25.9822 249.8286 29.9794 103.9287 223.8465 107.926 213.8533 275.8108",rooms:["第二体育館","武道場"]},{id:"_経営情報学科棟",name:"経営情報学科棟",points:"831.4297 835.427 831.4297 795.4544 935.3585 799.4517 935.3585 805.4476 955.3447 807.4462 955.3447 839.4243 831.4297 835.427",rooms:["情報処理実習室","経営学科事務室"]},{id:"_武道場",name:"武道場",points:"1187.1857 1169.1981 1131.2241 1165.2008 1129.2977 1008.296 1189.1844 1011.3064 1187.1857 1169.1981",rooms:["剣道場","柔道場"]},{id:"_ものづくり工房",name:"ものづくり工房",points:"793.4558 803.4489 739.4928 803.4489 741.4914 717.5079 795.4544 719.5065 793.4558 803.4489",rooms:["工房A","工房B"]},{id:"_実習工場",name:"実習工場",points:"287.8026 435.7012 73.9493 425.708 73.9493 388.4282 61.9575 385.7354 63.9561 369.7464 73.9493 369.7464 77.9465 305.7903 115.9205 307.7889 115.9205 321.7793 155.8931 321.7793 155.8931 335.7697 289.8012 345.7628 287.8026 435.7012",rooms:["加工実習室","溶接実習室"]},{id:"_経営情報学科棟-2",name:"経営情報学科棟2",points:"447.6929 447.6929 299.7944 441.697 301.793 409.719 293.7985 407.7204 295.7971 351.7587 451.6902 357.7546 447.6929 447.6929",rooms:["研究室","セミナー室"]},{id:"_実習工場-2",name:"実習工場2",points:"307.7889 643.5586 71.9507 637.5627 81.9438 487.6655 309.7875 495.66 307.8605 638.2678 307.7889 643.5586",rooms:["機械実習室","電気実習室"]},{id:"_制御情報工学科棟",name:"制御情報工学科棟",points:"425.708 565.6121 311.7862 563.6134 313.7848 503.6546 425.708 507.6518 425.708 565.6121",rooms:["制御実験室","プログラミング室"]},{id:"_地域共同テクノセンター",name:"地域共同テクノセンター",points:"425.708 641.56 307.8605 638.2678 308.815 567.6285 425.708 571.6079 425.708 641.56",rooms:["共同研究室","技術相談室"]},{id:"_管理棟",name:"管理棟",points:"267.8163 777.4668 263.8191 897.3845 387.7341 899.3831 387.7341 879.3968 433.7025 881.3955 431.7039 953.3461 63.9561 943.353 67.9534 893.3872 207.8574 895.3859 211.0996 776.0485 267.8163 777.4668",rooms:["事務室","受付","会議室"]},{id:"_機電棟",name:"機電棟",points:"439.6984 783.4626 267.8163 777.4668 211.0996 776.0485 69.952 771.4709 69.952 717.5079 439.6984 727.501 439.6984 783.4626",rooms:["機械工学科","電気工学科"]},{id:"_専攻科棟",name:"専攻科棟",points:"153.8944 1133.2227 57.9602 1135.2214 59.9589 1047.2817 243.8328 1053.2776 241.8341 1133.2227 171.8821 1131.2241 169.8835 1121.231 153.8944 1121.231 153.8944 1133.2227",rooms:["専攻科教室","研究室"]},{id:"_物質棟",name:"物質棟",points:"817.4393 1149.2118 531.6354 1141.2173 529.6367 1057.2748 549.623 1057.2748 549.623 1061.2721 591.5942 1063.2707 595.5915 1053.2776 887.3914 1069.2666 885.3927 1149.2118 835.427 1149.2118 817.4393 1149.2118",rooms:["化学実験室","材料工学科"]},{id:"_一般棟",name:"一般棟",points:"853.4147 963.3393 549.623 955.3447 547.6244 961.3406 511.6491 959.342 513.6477 889.39 553.6203 891.3886 555.6189 905.379 855.4133 917.3708 853.4147 963.3393",rooms:["一般教室","普通教室"]},{id:"_学生会館",name:"学生会館",points:"661.5463 791.4572 515.6463 785.4613 515.6463 675.5367 661.5463 675.5367 661.5463 791.4572",rooms:["学生ラウンジ","売店","食堂"]},{id:"_図書館棟",name:"図書館棟",points:"613.5792 365.7491 637.5627 365.7491 637.5627 415.7149 647.5559 415.7149 647.5559 451.6902 637.5627 451.6902 637.5627 499.6573 581.6011 499.6573 581.6011 545.6258 667.5421 545.6258 667.5421 629.5682 509.6504 629.5682 509.6504 535.6326 525.6395 535.6326 525.6395 497.6587 513.6477 497.6587 513.6477 359.7533 613.5792 361.7519 613.5792 365.7491",rooms:["図書館","閲覧室","情報検索室"]},{id:"_第一体育館",name:"第一体育館",points:"1077.2611 1197.1789 1069.2666 1197.1789 1065.2694 1227.1583 959.342 1225.1597 961.3406 1199.1775 953.3461 1199.1775 955.3447 979.3283 1081.2584 981.3269 1077.2611 1197.1789",rooms:["第一体育館","バスケットコート"]},{id:"D棟",name:"D棟",points:"1383.0514 949.3489 1335.0843 895.3859 1397.0418 835.427 1445.0089 887.3914 1383.0514 949.3489",rooms:["教室D101","教室D102"]},{id:"_浴場棟",name:"浴場棟",points:"1550.9362 639.5613 1490.9774 577.6038 1530.95 539.6299 1588.9102 603.586 1550.9362 639.5613",rooms:["浴場","洗面所"]},{id:"C棟",name:"C棟",points:"1506.9664 647.5559 1466.9938 687.5284 1476.987 697.5216 1457.0007 717.5079 1447.0075 707.5147 1385.05 769.4722 1393.0445 779.4654 1367.0624 805.4476 1357.5093 795.4229 1319.0953 833.4284 1285.1186 797.453 1472.9897 613.5792 1506.9664 647.5559",rooms:["教室C101","教室C102"]},{id:"_食堂棟",name:"食堂棟",points:"1361.0665 539.6299 1323.0925 501.6559 1371.0596 451.6902 1387.0487 467.6792 1399.0404 459.6847 1451.0048 517.645 1439.013 525.6395 1455.002 543.6271 1361.0665 633.5655 1313.0994 591.5942 1361.0665 539.6299",rooms:["食堂","厨房"]},{id:"_多目的交流施設",name:"多目的交流施設",points:"1177.1926 629.5682 1169.1981 617.5764 1196.1378 592.5182 1202.1337 600.5127 1229.1569 577.6038 1251.1419 605.5846 1233.1542 619.575 1243.1474 633.5655 1223.1611 651.5531 1215.1665 641.56 1165.2008 687.5284 1143.2159 661.5463 1177.1926 629.5682",rooms:["交流ホール","会議室"]}];Ie.map(M=>{const k=$e(M.points);return{centerX:k.x,centerY:k.y,id:M.id,name:M.name,polygon:M.points,rooms:M.rooms}});const y={height:1343.0788,width:1996.6306},He=({fullscreenLabel:M,isFullscreen:k=!1,maxScale:E,minScale:R,onReset:v,onToggleFullscreen:N,onZoomIn:P,onZoomOut:S,scale:T})=>{const X=o.useMemo(()=>T>=E,[T,E]),V=o.useMemo(()=>T<=R,[T,R]),$="flex items-center justify-center bg-white text-slate-700 transition-colors duration-150 hover:bg-slate-50 active:bg-slate-100 disabled:cursor-not-allowed disabled:opacity-40 touch-manipulation h-11 w-11 text-base font-semibold",B="flex items-center justify-center bg-slate-100 text-slate-700 transition-colors duration-150 hover:bg-slate-200 active:bg-slate-300 disabled:cursor-not-allowed disabled:opacity-40 touch-manipulation h-11 w-11 text-sm",O="flex flex-col overflow-hidden border border-slate-200 shadow-sm rounded-md bg-white",D="flex flex-col overflow-hidden border border-slate-200 shadow-sm rounded-md bg-slate-100";o.useEffect(()=>{const g=x=>{(x.ctrlKey||x.metaKey)&&x.key==="+"&&(x.preventDefault(),P()),(x.ctrlKey||x.metaKey)&&x.key==="-"&&(x.preventDefault(),S()),(x.ctrlKey||x.metaKey)&&x.key==="0"&&(x.preventDefault(),v())};return document.addEventListener("keydown",g),()=>document.removeEventListener("keydown",g)},[P,S,v]);const Z=()=>{N&&N()},tt=M??(k?"全画面表示を終了":"全画面表示");return e.jsxs("div",{className:"absolute right-4 bottom-4 z-20 flex w-auto flex-col items-end gap-2",style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased"},children:[e.jsxs("div",{className:O,children:[e.jsx("button",{type:"button",onClick:P,onTouchStart:g=>{g.stopPropagation()},onTouchEnd:g=>{g.stopPropagation(),g.currentTarget.disabled||P()},disabled:X,"aria-label":"ズームイン (Ctrl/Cmd + +)",className:`${$} border-b border-slate-200`,title:"ズームイン (Ctrl/Cmd + +)",style:{touchAction:"manipulation"},children:e.jsx(Be,{strokeWidth:2.5,className:"h-5 w-5",style:{vectorEffect:"non-scaling-stroke"}})}),e.jsx("button",{type:"button",onClick:S,onTouchStart:g=>{g.stopPropagation()},onTouchEnd:g=>{g.stopPropagation(),g.currentTarget.disabled||S()},disabled:V,"aria-label":"ズームアウト (Ctrl/Cmd + -)",className:$,title:"ズームアウト (Ctrl/Cmd + -)",style:{touchAction:"manipulation"},children:e.jsx(We,{strokeWidth:2.5,className:"h-5 w-5",style:{vectorEffect:"non-scaling-stroke"}})})]}),e.jsxs("div",{className:D,children:[e.jsx("button",{type:"button",onClick:v,onTouchStart:g=>{g.stopPropagation()},onTouchEnd:g=>{g.stopPropagation(),v()},"aria-label":"リセット (Ctrl/Cmd + 0)",className:`${B} border-b border-slate-100`,title:"リセット (Ctrl/Cmd + 0)",style:{touchAction:"manipulation"},children:e.jsx(_e,{strokeWidth:2.5,className:"h-5 w-5",style:{vectorEffect:"non-scaling-stroke"}})}),N&&e.jsx("button",{type:"button",onClick:Z,onTouchStart:g=>{g.stopPropagation()},onTouchEnd:g=>{g.stopPropagation(),Z()},"aria-label":tt,className:B,title:tt,style:{touchAction:"manipulation"},children:k?e.jsx(Le,{strokeWidth:2.5,className:"h-5 w-5",style:{vectorEffect:"non-scaling-stroke"}}):e.jsx(Ee,{strokeWidth:2.5,className:"h-5 w-5",style:{vectorEffect:"non-scaling-stroke"}})})]})]})},f={height:800,marginX:50,marginY:40,width:1100},Pe={event:Se,exhibit:Xe,location:Bt,stall:Bt},oe=18,ae=(M,k,E)=>Math.max(k,Math.min(E,M)),zt=(M,k)=>{const E=y.width,R=y.height,v=E/k,N=R/k;let P=E/2,S=R/2;if(M.length>0){const D=M.map(st=>st.coordinates.x),Z=M.map(st=>st.coordinates.y),tt=Math.min(...D),g=Math.max(...D),x=Math.min(...Z),vt=Math.max(...Z);P=(tt+g)/2,S=(x+vt)/2}const T=E*.2,X=R*.2,V=-T,$=E+T-v,B=-X,O=R+X-N;return{height:N,width:v,x:ae(P-v/2,V,$),y:ae(S-N/2,B,O)}},ie=(M,k,E)=>k==="display"&&M.length>0?zt(M,E):zt([],E),Ge=({className:M="",enableFullscreen:k=!0,fullscreenLabel:E,height:R="400px",highlightPoint:v,initialZoom:N=1,isFullscreen:P,maxZoom:S=10,minZoom:T=.1,mode:X="display",onMapClick:V,onPointClick:$,onPointHover:B,onToggleFullscreen:O,points:D=[],showControls:Z=!0})=>{const{t:tt}=Ce(),g=o.useRef(null),x=o.useRef(null),[vt,st]=o.useState(!1),[Wt,$t]=o.useState(null),dt=k!==!1,Y=typeof P=="boolean"?P:vt,ce=E??tt(Y?"map.exitFullscreen":"map.enterFullscreen"),[i,F]=o.useState(()=>ie(D,X,N)),[et,ot]=o.useState(!1),[U,jt]=o.useState({x:0,y:0}),[I,Mt]=o.useState(i),[le,Nt]=o.useState(null),[It,re]=o.useState(0),[Ht,Pt]=o.useState(N),de=o.useCallback(()=>{if(dt){if(!Y&&x.current){const t=x.current.getBoundingClientRect();t.height>0&&$t(t.height)}if(O){O();return}st(t=>!t)}},[dt,O,Y]);o.useEffect(()=>{const t=y.width/i.width;Pt(t)},[i.width]),o.useEffect(()=>{if(!Y&&x.current){const t=x.current.getBoundingClientRect();t.height>0&&$t(n=>n===null||Math.abs(n-t.height)>1?t.height:n)}},[Y,R]);const[ht,Vt]=o.useState(!1),[Ot,he]=o.useState(0),[at,me]=o.useState({x:0,y:0}),[nt,xt]=o.useState(!1),[G,it]=o.useState(null),[q,ct]=o.useState(null),[lt,kt]=o.useState({x:0,y:0}),[mt,Yt]=o.useState(null),[Ft,Ct]=o.useState(null),[Gt,ue]=o.useState(0),K=o.useCallback(()=>{G&&it(null),q&&ct(null),Yt(null),Ct(null)},[G,q]),rt=o.useCallback(t=>{const n=y.width/y.height,l=t.width/t.height;let s,u,c,a;return n>l?(s=t.width,u=t.width/n,c=0,a=(t.height-u)/2):(s=t.height*n,u=t.height,c=(t.width-s)/2,a=0),{height:u,offsetX:c,offsetY:a,width:s}},[]),Q=o.useCallback((t,n)=>{if(!g.current)return{x:0,y:0};const l=g.current.getBoundingClientRect(),s=t-l.left,u=n-l.top,c=rt(l),a=s-c.offsetX,r=u-c.offsetY,d=i.x+a/c.width*i.width,h=i.y+r/c.height*i.height;return{x:d,y:h}},[i,rt]),pe=o.useCallback(()=>{F(t=>{const l=t.width*.8,s=t.height*.8,u=t.x+t.width/2,c=t.y+t.height/2,a=y.width,r=y.height,d=a*.1,h=r*.1,m=a+d-l,p=-598.9891799999999,w=r+h-s;return{height:Math.max(s,(f.height+f.marginY*2)/S),width:Math.max(l,(f.width+f.marginX*2)/S),x:Math.max(p,Math.min(m,u-l/2)),y:Math.max(-402.92364,Math.min(w,c-s/2))}})},[S]),ge=o.useCallback(()=>{F(t=>{const l=t.width*1.25,s=t.height*1.25,u=t.x+t.width/2,c=t.y+t.height/2,a=y.width,r=y.height,d=a*.1,h=r*.1,m=a+d-l,p=-598.9891799999999,w=r+h-s;return{height:Math.min(s,(f.height+f.marginY*2)/T),width:Math.min(l,(f.width+f.marginX*2)/T),x:Math.max(p,Math.min(m,u-l/2)),y:Math.max(-402.92364,Math.min(w,c-s/2))}})},[T]),fe=o.useCallback(()=>{F(ie(D,X,N))},[D,X,N]),yt=o.useCallback((t,n=2)=>{const l=y.width/n,s=y.height/n,u=y.width,c=y.height,a=u*.1,r=c*.1,d=u+a-l,h=-598.9891799999999,m=c+r-s,p=-402.92364,w=t.x-l/2,b=t.y-s/2;F({height:s,width:l,x:Math.max(h,Math.min(d,w)),y:Math.max(p,Math.min(m,b))})},[]),xe=o.useCallback(()=>{Nt(null),B==null||B(null)},[B]),ye=o.useCallback(t=>{t.button===0&&(K(),ht?(jt({x:t.clientX,y:t.clientY}),Mt(i),ot(!0)):(ot(!0),jt({x:t.clientX,y:t.clientY}),Mt(i)),t.preventDefault())},[i,K,ht]),Xt=o.useCallback(t=>{if(!et||!x.current)return;const n=x.current.getBoundingClientRect(),l=t.clientX-U.x,s=t.clientY-U.y;if(ht){const z=Math.hypot(l,s)>0?Math.max(.5,Math.min(2,1+s/100)):1,W=Q(U.x,U.y),L=I.width*z,C=I.height*z;F({height:C,width:L,x:W.x-L/2,y:W.y-C/2});return}const u=i.width/n.width,c=i.height/n.height,a=I.x-l*u,r=I.y-s*c,d=y.width,h=y.height,m=d*.1,p=h*.1,w=d+m-i.width,b=-598.9891799999999,j=h+p-i.height;F({height:I.height,width:I.width,x:Math.max(b,Math.min(w,a)),y:Math.max(-402.92364,Math.min(j,r))})},[et,U,I,i.width,i.height,ht,Q]),St=o.useCallback(()=>{ot(!1)},[]),[Tt,Et]=o.useState(0),bt=o.useCallback(t=>{if(t.length<2)return 0;const n=t[0].clientX-t[1].clientX,l=t[0].clientY-t[1].clientY;return Math.hypot(n,l)},[]),Ut=o.useCallback(t=>t.length===1?{x:t[0].clientX,y:t[0].clientY}:{x:(t[0].clientX+t[1].clientX)/2,y:(t[0].clientY+t[1].clientY)/2},[]),be=o.useCallback(t=>{const n=Date.now();he(n),me({x:t.touches[0].clientX,y:t.touches[0].clientY}),xt(!1),t.touches.length===1?(ot(!0),jt({x:t.touches[0].clientX,y:t.touches[0].clientY}),Mt(i)):t.touches.length===2&&(K(),ot(!1),Et(bt(t.touches)),xt(!0))},[i,K,bt]),Dt=o.useCallback(t=>{if(!x.current)return;const n=document.querySelectorAll(".map-card-overlay");let l=!1;for(const a of n){const r=a.getBoundingClientRect();if(t.touches[0].clientX>=r.left&&t.touches[0].clientX<=r.right&&t.touches[0].clientY>=r.top&&t.touches[0].clientY<=r.bottom){l=!0;break}}if(l)return;const s=t.touches[0].clientX-at.x,u=t.touches[0].clientY-at.y,c=Math.hypot(s,u);if(c>5&&!nt&&(xt(!0),K()),(nt||c>5||t.touches.length>1)&&t.cancelable)try{t.preventDefault()}catch(a){console.debug("preventDefault failed on touchmove:",a)}if(t.touches.length===1&&et&&x.current&&(nt||c>5)){const a=t.touches[0].clientX-U.x,r=t.touches[0].clientY-U.y,d=x.current.getBoundingClientRect(),h=i.width/d.width,m=i.height/d.height,p=I.x-a*h,w=I.y-r*m,b=y.width,j=y.height,_=b*.1,A=j*.1,z=b+_-i.width,W=-598.9891799999999,L=j+A-i.height;F({height:I.height,width:I.width,x:Math.max(W,Math.min(z,p)),y:Math.max(-402.92364,Math.min(L,w))})}else if(t.touches.length===2&&Tt>0){const a=bt(t.touches),r=Ut(t.touches),d=Tt/a,h=Q(r.x,r.y);F(m=>{const p=Math.max(Math.min(m.width*d,(f.width+f.marginX*2)/T),(f.width+f.marginX*2)/S),w=Math.max(Math.min(m.height*d,(f.height+f.marginY*2)/T),(f.height+f.marginY*2)/S),b=y.width,j=y.height,_=b*.1,A=j*.1,z=b+_-p,W=-598.9891799999999,L=j+A-w;return{height:w,width:p,x:Math.max(W,Math.min(z,h.x-(h.x-m.x)*(p/m.width))),y:Math.max(-402.92364,Math.min(L,h.y-(h.y-m.y)*(w/m.height)))}}),Et(a)}},[et,U,I,Tt,Q,T,S,i.width,i.height,bt,at,nt,K,Ut]),Lt=o.useCallback(t=>{if(!x.current)return;const n=Date.now(),l=n-Ot,s=t.changedTouches[0],u=document.querySelectorAll(".map-card-overlay");let c=!1;for(const m of u){const p=m.getBoundingClientRect();if(s.clientX>=p.left&&s.clientX<=p.right&&s.clientY>=p.top&&s.clientY<=p.bottom){c=!0;break}}if(c)return;const a=s.clientX-at.x,r=s.clientY-at.y,d=Math.hypot(a,r);if(l<500&&d<10&&!nt&&t.touches.length===0){const m=n-It;if(m<300&&m>0){const p=Q(s.clientX,s.clientY),w=[1,2,4,8],j=(w.findIndex(A=>Math.abs(Ht-A)<.5)+1)%w.length,_=w[j];yt(p,_),Pt(_),t.cancelable&&t.preventDefault();return}else{if(re(n),g.current&&X==="interactive"&&V){const p=g.current.getBoundingClientRect(),w=s.clientX-p.left,b=s.clientY-p.top,j=rt(p),_=w-j.offsetX,A=b-j.offsetY,z=i.x+_/j.width*i.width,W=i.y+A/j.height*i.height,L=Math.max(y.width,y.height)*2,C=Math.max(-L,Math.min(y.width+L,z)),H=Math.max(-L,Math.min(y.height+L,W)),pt=Math.round(C*100)/100,gt=Math.round(H*100)/100;setTimeout(()=>{V({x:pt,y:gt})},10)}return}}if((nt||d>10)&&t.cancelable)try{t.preventDefault()}catch{}t.touches.length===0&&(ot(!1),Et(0),xt(!1))},[It,Ht,Q,yt,Ot,at,nt,X,V,rt,i]),Rt=o.useCallback(t=>{if(!x.current)return;const n=document.querySelectorAll(".map-card-overlay");let l=!1;for(const c of n){const a=c.getBoundingClientRect();if(t.clientX>=a.left&&t.clientX<=a.right&&t.clientY>=a.top&&t.clientY<=a.bottom){l=!0;break}}if(l)return;t.preventDefault(),K();const s=Q(t.clientX,t.clientY),u=t.deltaY>0?1.1:.9;F(c=>{const a=Math.max(Math.min(c.width*u,(f.width+f.marginX*2)/T),(f.width+f.marginX*2)/S),r=Math.max(Math.min(c.height*u,(f.height+f.marginY*2)/T),(f.height+f.marginY*2)/S),d=y.width,h=y.height,m=d*.1,p=h*.1,w=d+m-a,b=-598.9891799999999,j=h+p-r;return{height:r,width:a,x:Math.max(b,Math.min(w,s.x-(s.x-c.x)*(a/c.width))),y:Math.max(-402.92364,Math.min(j,s.y-(s.y-c.y)*(r/c.height)))}})},[Q,T,S,K]),ut=o.useCallback((t,n,l=!1)=>{var L;if(!x.current)return{placement:"bottom",x:0,y:0};const s=x.current.getBoundingClientRect(),u=l?400:300,c=l?300:200,a=20;let r,d;if(n)r=n.clientX-s.left,d=n.clientY-s.top;else{const C=(L=g.current)==null?void 0:L.getBoundingClientRect();C?(r=(t.x-i.x)/i.width*C.width,d=(t.y-i.y)/i.height*C.height):(r=s.width/2,d=s.height/2)}const h=s.width/3,m=s.width*2/3,p=s.height/3,w=s.height*2/3;let b={bottom:1,left:4,right:3,top:2};r<h?b={bottom:2,left:4,right:1,top:3}:r>m&&(b={bottom:2,left:1,right:4,top:3}),d<p?b={bottom:1,left:3,right:2,top:4}:d>w&&(b={bottom:4,left:3,right:2,top:1});const j=[{finalX:r,finalY:d+50,name:"bottom",priority:b.bottom,spaceAvailable:s.height-(d+50+c+a),transform:"translate(-50%, 0%)",viable:d+50+c+a<s.height,x:r,y:d+50},{finalX:r,finalY:d-50,name:"top",priority:b.top,spaceAvailable:d-50-c-a,transform:"translate(-50%, -100%)",viable:d-50-c-a>0,x:r,y:d-50},{finalX:r+50,finalY:d,name:"right",priority:b.right,spaceAvailable:s.width-(r+50+u+a),transform:"translate(0%, -50%)",viable:r+50+u+a<s.width,x:r+50,y:d},{finalX:r-50,finalY:d,name:"left",priority:b.left,spaceAvailable:r-50-u-a,transform:"translate(-100%, -50%)",viable:r-50-u-a>0,x:r-50,y:d}],_=j.filter(C=>C.viable),A=_.length>0?[..._].sort((C,H)=>{const pt=C.spaceAvailable>50,gt=H.spaceAvailable>50;return pt&&!gt?-1:!pt&&gt?1:pt&&gt?C.priority-H.priority:H.spaceAvailable-C.spaceAvailable})[0]:[...j].sort((C,H)=>H.spaceAvailable-C.spaceAvailable)[0];let z=A.finalX,W=A.finalY;return A.viable||(z=s.width/2,W=s.height/2),{placement:A.name,transform:A.transform,x:z,y:W}},[i]),qt=o.useCallback((t,n,l)=>{var u,c;const s=Date.now();if(l&&t.contentItem)if(Ft===t.id&&s-Gt<2e3&&mt===t.id){(u=t.onClick)==null||u.call(t),$==null||$(t.id),Yt(null),Ct(null);return}else{Yt(t.id),Ct(t.id),ue(s),it(t),ct(null);const a=ut(t.coordinates,n,!1);kt(a);return}if(t.contentItem){it(t),ct(null);const a=ut(t.coordinates,n,!1);kt(a)}(c=t.onClick)==null||c.call(t),$==null||$(t.id)},[$,Ft,Gt,mt,ut]),wt=o.useCallback((t,n)=>{ct(t.points),it(null);const l=ut(t.coordinates,n,!0);kt(l)},[ut]),Kt=o.useCallback(t=>{var l;const n=(t==null?void 0:t.id)||null;Nt(n),B==null||B(n),(l=t==null?void 0:t.onHover)==null||l.call(t,!!t)},[B]),we=o.useCallback(t=>{if(!et&&((G||q)&&t.target===g.current&&(it(null),ct(null)),X==="interactive"&&V)){if(!g.current)return;const n=g.current.getBoundingClientRect(),l=Math.max(n.width,n.height)*10;if(t.clientX<n.left-l||t.clientX>n.right+l||t.clientY<n.top-l||t.clientY>n.bottom+l)return;const s=t.clientX-n.left,u=t.clientY-n.top,c=rt(n),a=s-c.offsetX,r=u-c.offsetY,d=i.x+a/c.width*i.width,h=i.y+r/c.height*i.height,m=Math.max(y.width,y.height)*2,p=Math.max(-m,Math.min(y.width+m,d)),w=Math.max(-m,Math.min(y.height+m,h)),b=Math.round(p*100)/100,j=Math.round(w*100)/100;V({x:b,y:j})}},[et,X,V,i,G,q,rt]),_t=o.useCallback(t=>{t.key==="Shift"&&Vt(!0)},[]),At=o.useCallback(t=>{t.key==="Shift"&&Vt(!1)},[]);o.useEffect(()=>{const t=x.current;if(t)return document.addEventListener("mousemove",Xt),document.addEventListener("mouseup",St),t.addEventListener("touchmove",Dt,{passive:!1}),t.addEventListener("touchend",Lt,{passive:!1}),t.addEventListener("wheel",Rt,{passive:!1}),document.addEventListener("keydown",_t),document.addEventListener("keyup",At),()=>{document.removeEventListener("mousemove",Xt),document.removeEventListener("mouseup",St),t.removeEventListener("touchmove",Dt),t.removeEventListener("touchend",Lt),t.removeEventListener("wheel",Rt),document.removeEventListener("keydown",_t),document.removeEventListener("keyup",At)}},[Xt,St,Dt,Lt,Rt,_t,At]);const Qt=o.useCallback(()=>{D.length!==0&&F(zt(D,N))},[D,N]),[Jt,Zt]=o.useState(!1);o.useEffect(()=>{if(v&&X==="detail"&&!Jt){const t=setTimeout(()=>{yt(v,4),Zt(!0)},500);return()=>clearTimeout(t)}},[v,X,yt,Jt]),o.useEffect(()=>{if(X==="display"&&D.length>0){const t=requestAnimationFrame(()=>Qt());return()=>cancelAnimationFrame(t)}},[X,D.length,Qt]),o.useEffect(()=>{Zt(!1)},[v]);const J=o.useCallback((t=8)=>{const n=(f.width+f.marginX*2)/i.width;return Math.max(t/Math.sqrt(n),4)},[i.width]),te=o.useCallback(()=>{const t=(f.width+f.marginX*2)/i.width;return Math.max(12/Math.sqrt(t),8)},[i.width]),ee=o.useCallback(()=>X==="detail"?!1:(f.width+f.marginX*2)/i.width>=1.5,[i.width,X]),ve=o.useCallback(t=>{const n=i.x+i.width/2;return t>n?"left":"right"},[i.x,i.width]),je=35,ne=o.useCallback(()=>{if(D.length===0)return[];const t=(c,a)=>Math.sqrt(Math.pow(a.x-c.x,2)+Math.pow(a.y-c.y,2)),n=[],l=new Set,s=(f.width+f.marginX*2)/i.width,u=je/Math.sqrt(s);for(const c of D){if(l.has(c.id))continue;const a=[c];l.add(c.id);for(const h of D){if(l.has(h.id))continue;t(c.coordinates,h.coordinates)<=u&&(a.push(h),l.add(h.id))}const r=a.reduce((h,m)=>h+m.coordinates.x,0)/a.length,d=a.reduce((h,m)=>h+m.coordinates.y,0)/a.length;n.push({coordinates:{x:r,y:d},count:a.length,id:`cluster-${a.map(h=>h.id).sort((h,m)=>h.localeCompare(m)).join("-")}`,points:a})}return n},[D,i.width]),Me=o.useMemo(()=>ne(),[ne]);o.useEffect(()=>{if(!dt||!Y)return;const t=document.body.style.overflow;document.body.style.overflow="hidden";const n=l=>{l.key==="Escape"&&(O?O():st(!1))};return globalThis.addEventListener("keydown",n),()=>{document.body.style.overflow=t,globalThis.removeEventListener("keydown",n)}},[dt,O,Y]),o.useEffect(()=>()=>{it(null),ct(null),Nt(null)},[]);const Ne=Y?Wt===null?R?{minHeight:R,width:"100%"}:{width:"100%"}:{height:`${Wt}px`,width:"100%"}:void 0,ke=["relative overflow-hidden vector-map-container",M,Y?"rounded-none":""].filter(Boolean).join(" "),Ye={backgroundColor:Y?"var(--color-bg-secondary)":void 0,borderRadius:Y?0:void 0,boxShadow:Y?"0 20px 40px rgba(15, 23, 42, 0.35)":void 0,cursor:et?"grabbing":ht?"zoom-in":"grab",height:Y?"100vh":R,imageRendering:"optimizeQuality",inset:Y?0:void 0,maxWidth:Y?"100vw":"100%",position:Y?"fixed":void 0,shapeRendering:"geometricPrecision",touchAction:"manipulation",userSelect:"none",WebkitTouchCallout:"none",WebkitUserSelect:"none",width:Y?"100vw":"100%",zIndex:Y?60:void 0};return e.jsxs(e.Fragment,{children:[Y&&e.jsx("div",{"aria-hidden":"true",className:"w-full",style:Ne}),e.jsxs("div",{ref:x,className:ke,style:Ye,children:[Z&&e.jsx(He,{onZoomIn:pe,onZoomOut:ge,onReset:fe,onToggleFullscreen:dt?de:void 0,isFullscreen:Y,fullscreenLabel:ce,scale:y.width/i.width,minScale:T,maxScale:S}),e.jsxs("svg",{ref:g,className:"h-full w-full",viewBox:`${i.x} ${i.y} ${i.width} ${i.height}`,preserveAspectRatio:"xMidYMid meet",onMouseDown:ye,onTouchStart:be,onClick:we,onMouseLeave:xe,style:{backfaceVisibility:"hidden",shapeRendering:"geometricPrecision",textRendering:"geometricPrecision",vectorEffect:"non-scaling-stroke",willChange:"transform"},children:[e.jsx("defs",{children:e.jsx("style",{children:`
              .map-base { fill: #e6e6e6; }
              .map-roof { fill: #b3b3b3; }
              .map-building { fill: gray; }
              ${X==="interactive"?`.map-building { pointer-events: none; }
                     .map-building:hover { fill: #666; }`:""}
              .map-point { cursor: pointer; transition: all 0.2s ease; }
               
              .map-text { 
                font-family: system-ui, -apple-system, sans-serif;
                font-weight: 600;
                text-anchor: middle;
                dominant-baseline: central;
                pointer-events: none;
                paint-order: stroke fill;
                stroke: white;
                stroke-width: 2;
                stroke-linecap: round;
                stroke-linejoin: round;
              }
            `})}),e.jsxs("g",{id:"base",children:[e.jsx("polygon",{className:"map-base",points:"709.5134 643.5586 769.4722 667.5421 813.4421 701.5188 835.427 731.4983 975.331 815.4407 1053.2776 809.4448 1079.2598 835.427 1067.268 849.4174 693.5243 835.427 695.523 759.4791 699.5202 637.5627 701.5188 621.5737 717.5079 543.6271 657.549 405.7217 645.5572 411.7176 689.5271 521.6422 695.523 549.623 683.5312 631.5668 679.5339 653.5517 675.5367 821.4366 673.538 831.4297 657.549 835.427 503.6546 831.4297 491.6628 825.4339 487.6655 805.4476 497.6587 321.7789 493.6614 313.7848 169.8835 305.7903 163.8876 309.7875 165.8862 325.7766 447.6929 337.7683 459.6847 349.7601 461.6833 451.6902 67.9534 441.697 69.952 395.7286 57.9602 391.7313 57.9602 365.7491 63.9561 309.7875 75.9479 301.793 77.9465 277.8095 35.9753 281.8067 31.9781 331.7724 37.974 463.682 25.9822 971.3338 13.9904 955.3447 5.9959 933.3598 9.9931 97.9328 9.9931 0 501.6559 0 569.6093 205.8588 725.5024 547.6244 709.5134 643.5586"}),e.jsx("polygon",{className:"map-base",points:"459.6847 651.5531 447.6929 661.5463 67.9534 655.5504 65.9548 569.6093 73.9493 463.682 459.6847 477.6724 459.6847 651.5531"}),e.jsx("polygon",{className:"map-base",points:"453.6888 961.3406 428.1581 976.6573 242.4325 971.3509 231.841 957.3434 197.8643 959.342 191.8684 969.3352 53.963 967.3365 49.9657 959.342 49.9657 835.427 55.9616 831.4297 59.9589 815.4407 65.9548 691.5257 77.9465 681.5326 169.8835 681.5326 249.8286 689.5271 375.7423 689.5271 445.6943 693.5243 455.6875 703.5175 449.6916 905.379 453.6888 961.3406"}),e.jsx("polygon",{className:"map-base",points:"321.7793 1193.1816 315.7834 1193.1816 263.8191 1187.1857 21.9849 1185.1871 0 1169.1981 3.9973 1045.2831 7.9945 1021.2995 23.9836 1009.3077 159.7644 1011.3064 167.8849 1015.3036 171.8821 1023.2981 173.8807 1037.2885 251.8273 1039.2872 275.8108 1043.2844 275.8108 1115.2351 279.8081 1121.231 351.7587 1123.2296 357.7546 1125.2282 359.7533 1129.2255 355.756 1161.2036 337.7683 1173.1953 321.7793 1193.1816"}),e.jsx("polygon",{className:"map-base",points:"907.3776 1161.2036 869.4037 1165.2008 695.523 1157.2063 525.6395 1157.2063 483.6683 1097.2474 485.6669 933.3598 491.6628 875.3996 499.6573 865.4064 547.6244 859.4105 727.501 871.4023 905.379 877.3982 911.3749 883.3941 907.3776 1161.2036"}),e.jsx("polygon",{className:"map-base",points:"905.379 1289.1158 847.4188 1273.1268 489.6641 1213.1679 455.6875 1165.2008 421.7108 1165.2008 419.7121 1151.2104 437.6998 1149.2118 439.6984 1133.2227 475.6737 1133.2227 481.6696 1145.2145 507.6518 1177.1926 523.6408 1183.1885 881.3955 1201.1761 901.3818 1221.1624 907.3776 1229.1569 905.379 1289.1158"}),e.jsx("polygon",{className:"map-base",points:"1099.2461 1245.146 959.342 1249.1432 943.353 1243.1474 941.3543 1065.2694 941.3543 913.3735 945.3516 905.379 953.3461 905.379 1087.2543 923.3667 1105.2419 939.3557 1099.2461 1245.146"}),e.jsx("polygon",{className:"map-base",points:"1097.2474 1339.0816 1087.2543 1343.0788 965.3379 1303.1062 951.3475 1283.1199 955.3447 1275.1254 1123.2296 1269.1295 1125.2282 921.3681 1117.2337 905.379 989.3214 891.3886 985.3242 883.3941 991.3201 879.3968 1113.2365 877.3982 1301.1076 1083.257 1097.2474 1339.0816"})]}),e.jsxs("g",{id:"roof",children:[e.jsx("polygon",{className:"map-roof",points:"199.8629 797.453 79.9452 793.4558 79.9452 781.464 201.8615 783.4626 199.8629 797.453"}),e.jsx("polygon",{className:"map-roof",points:"191.8684 815.4407 77.9465 811.4434 77.9465 799.4517 193.867 801.4503 191.8684 815.4407"}),e.jsx("polygon",{className:"map-roof",points:"91.9369 867.4051 131.9095 869.4037 129.9109 881.3955 61.9575 879.3968 59.9589 845.4201 91.9369 849.4174 91.9369 867.4051"}),e.jsx("polygon",{className:"map-roof",points:"201.8615 833.4284 199.8629 879.3968 149.8972 877.3982 151.8958 857.4119 95.9342 853.4147 95.9342 839.4243 151.8958 841.4229 153.8944 831.4297 201.8615 833.4284"}),e.jsx("polygon",{className:"map-roof",points:"319.7807 817.4393 297.7957 817.4393 297.7957 797.453 319.6326 797.2852 319.7807 817.4393"}),e.jsx("polygon",{className:"map-roof",points:"743.4901 911.3749 583.5997 905.379 583.5997 885.3927 745.4887 889.39 743.4901 911.3749"}),e.jsx("polygon",{className:"map-roof",points:"731.4983 985.3242 631.5668 981.3269 631.5668 969.3352 733.4969 973.3324 731.4983 985.3242"}),e.jsx("polygon",{className:"map-roof",points:"851.416 987.3228 745.4887 985.3242 745.4887 971.3338 851.416 973.3324 851.416 987.3228"}),e.jsx("rect",{className:"map-roof",x:"535.6326",y:"621.5737",width:"31.9781",height:"61.9575"}),e.jsx("rect",{className:"map-roof",x:"801.4503",y:"737.4942",width:"27.9808",height:"67.9534"}),e.jsx("polygon",{className:"map-roof",points:"735.4955 809.4448 703.5175 809.4448 705.5161 747.4873 735.4955 747.4873 735.4955 809.4448"}),e.jsx("polygon",{className:"map-roof",points:"759.4791 719.5065 741.4914 719.5065 743.4901 677.5353 759.4791 679.5339 759.4791 719.5065"}),e.jsx("polygon",{className:"map-roof",points:"677.5353 1043.2844 641.56 1043.2844 641.56 1023.2981 661.5463 1023.2981 661.5463 1015.3036 679.5339 1015.3036 677.5353 1043.2844"}),e.jsx("polygon",{className:"map-roof",points:"625.5709 1027.2954 593.5929 1025.2968 593.5929 1015.3036 627.5696 1017.3023 625.5709 1027.2954"}),e.jsx("rect",{className:"map-roof",x:"565.6121",y:"1011.3064",width:"21.9849",height:"19.9863"}),e.jsx("polygon",{className:"map-roof",points:"1071.2652 985.3242 965.3379 985.3242 965.3379 949.3489 1071.2652 953.3461 1071.2652 985.3242"}),e.jsx("polygon",{className:"map-roof",points:"743.4901 1041.2858 687.5284 1039.2872 689.5271 1019.3009 743.4901 1021.2995 743.4901 1041.2858"}),e.jsx("polygon",{className:"map-roof",points:"797.453 1035.2899 765.475 1035.2899 767.4736 1015.3036 799.4517 1017.3023 797.453 1035.2899"}),e.jsx("polygon",{className:"map-roof",points:"895.3859 1037.2885 823.4352 1033.2913 823.4352 1019.3009 895.3859 1023.2981 895.3859 1037.2885"}),e.jsx("polygon",{className:"map-roof",points:"907.3776 977.3297 883.3941 977.3297 885.3927 889.39 908.5597 889.823 907.3776 977.3297"}),e.jsx("polygon",{className:"map-roof",points:"881.3955 937.3571 869.4037 937.3571 869.4037 889.39 883.3941 889.39 881.3955 937.3571"}),e.jsx("polygon",{className:"map-roof",points:"325.7766 885.3927 309.7875 885.3927 313.7848 867.4051 327.7752 869.4037 325.7766 885.3927"}),e.jsx("polygon",{className:"map-roof",points:"347.7615 883.3941 333.7711 883.3941 335.7697 869.4037 349.7601 871.4023 347.7615 883.3941"}),e.jsx("polygon",{className:"map-roof",points:"369.7464 885.3927 357.7546 885.3927 357.7546 869.4037 369.7464 871.4023 369.7464 885.3927"}),e.jsx("rect",{className:"map-roof",x:"423.7094",y:"907.3776",width:"93.9356",height:"11.9918"}),e.jsx("polygon",{className:"map-roof",points:"217.8506 705.5161 157.8917 699.5202 159.8903 685.5298 219.8492 689.5271 217.8506 705.5161"}),e.jsx("polygon",{className:"map-roof",points:"321.7793 717.5079 265.8177 715.5092 267.8163 693.5243 321.7793 693.5243 321.7793 717.5079"}),e.jsx("rect",{className:"map-roof",x:"343.7642",y:"695.523",width:"53.963",height:"21.9849"}),e.jsx("polygon",{className:"map-roof",points:"353.7574 1151.2104 321.7793 1149.2118 321.7793 1129.2255 353.7574 1131.2241 353.7574 1151.2104"})]}),e.jsxs("g",{id:"buildings",children:[e.jsx("polygon",{id:"第二体育館",className:"map-building",points:"213.8533 275.8108 133.9082 275.8108 131.9095 283.8053 109.9246 283.8053 109.9246 273.8122 81.9438 273.8122 81.9438 251.8273 25.9822 249.8286 29.9794 103.9287 223.8465 107.926 213.8533 275.8108"}),e.jsx("polygon",{id:"管理棟",className:"map-building",points:"267.8163 777.4668 263.8191 897.3845 387.7341 899.3831 387.7341 879.3968 433.7025 881.3955 431.7039 953.3461 63.9561 943.353 67.9534 893.3872 207.8574 895.3859 211.0996 776.0485 267.8163 777.4668"}),e.jsx("polygon",{id:"図書館棟",className:"map-building",points:"613.5792 365.7491 637.5627 365.7491 637.5627 415.7149 647.5559 415.7149 647.5559 451.6902 637.5627 451.6902 637.5627 499.6573 581.6011 499.6573 581.6011 545.6258 667.5421 545.6258 667.5421 629.5682 509.6504 629.5682 509.6504 535.6326 525.6395 535.6326 525.6395 497.6587 513.6477 497.6587 513.6477 359.7533 613.5792 361.7519 613.5792 365.7491"}),e.jsx("polygon",{id:"学生会館",className:"map-building",points:"661.5463 791.4572 515.6463 785.4613 515.6463 675.5367 661.5463 675.5367 661.5463 791.4572"}),e.jsx("polygon",{id:"物質棟",className:"map-building",points:"817.4393 1149.2118 531.6354 1141.2173 529.6367 1057.2748 549.623 1057.2748 549.623 1061.2721 591.5942 1063.2707 595.5915 1053.2776 887.3914 1069.2666 885.3927 1149.2118 835.427 1149.2118 817.4393 1149.2118"}),e.jsx("polygon",{id:"一般棟",className:"map-building",points:"853.4147 963.3393 549.623 955.3447 547.6244 961.3406 511.6491 959.342 513.6477 889.39 553.6203 891.3886 555.6189 905.379 855.4133 917.3708 853.4147 963.3393"}),e.jsx("polygon",{id:"第一体育館",className:"map-building",points:"1077.2611 1197.1789 1069.2666 1197.1789 1065.2694 1227.1583 959.342 1225.1597 961.3406 1199.1775 953.3461 1199.1775 955.3447 979.3283 1081.2584 981.3269 1077.2611 1197.1789"}),e.jsx("polygon",{id:"経営情報学科棟",className:"map-building",points:"831.4297 835.427 831.4297 795.4544 935.3585 799.4517 935.3585 805.4476 955.3447 807.4462 955.3447 839.4243 831.4297 835.427"}),e.jsx("polygon",{id:"ものづくり工房",className:"map-building",points:"793.4558 803.4489 739.4928 803.4489 741.4914 717.5079 795.4544 719.5065 793.4558 803.4489"}),e.jsx("polygon",{id:"実習工場",className:"map-building",points:"287.8026 435.7012 73.9493 425.708 73.9493 388.4282 61.9575 385.7354 63.9561 369.7464 73.9493 369.7464 77.9465 305.7903 115.9205 307.7889 115.9205 321.7793 155.8931 321.7793 155.8931 335.7697 289.8012 345.7628 287.8026 435.7012"}),e.jsx("polygon",{id:"経営情報学科棟2",className:"map-building",points:"447.6929 447.6929 299.7944 441.697 301.793 409.719 293.7985 407.7204 295.7971 351.7587 451.6902 357.7546 447.6929 447.6929"}),e.jsx("polygon",{id:"実習工場2",className:"map-building",points:"307.7889 643.5586 71.9507 637.5627 81.9438 487.6655 309.7875 495.66 307.8605 638.2678 307.7889 643.5586"}),e.jsx("polygon",{id:"制御情報工学科棟",className:"map-building",points:"425.708 565.6121 311.7862 563.6134 313.7848 503.6546 425.708 507.6518 425.708 565.6121"}),e.jsx("polygon",{id:"地域共同テクノセンター",className:"map-building",points:"425.708 641.56 307.8605 638.2678 308.815 567.6285 425.708 571.6079 425.708 641.56"}),e.jsx("polygon",{id:"機電棟",className:"map-building",points:"439.6984 783.4626 267.8163 777.4668 211.0996 776.0485 69.952 771.4709 69.952 717.5079 439.6984 727.501 439.6984 783.4626"}),e.jsx("polygon",{id:"専攻科棟",className:"map-building",points:"153.8944 1133.2227 57.9602 1135.2214 59.9589 1047.2817 243.8328 1053.2776 241.8341 1133.2227 171.8821 1131.2241 169.8835 1121.231 153.8944 1121.231 153.8944 1133.2227"}),e.jsx("polygon",{className:"map-building",points:"533.634 1111.2378 511.6491 1111.2378 513.6477 957.3434 533.634 957.3434 533.634 1111.2378"}),e.jsx("polygon",{id:"武道場",className:"map-building",points:"1187.1857 1169.1981 1131.2241 1165.2008 1129.2977 1008.296 1189.1844 1011.3064 1187.1857 1169.1981"})]}),e.jsx("g",{id:"points",children:Me.map(t=>{if(t.count===1){const n=t.points[0],l=n.color||Ve(n.type),s=Math.max(J(n.size||8),6),u=s*1.6,c=s*.95,a=-u-s*.3,r=-(u+s),d=s*.55,h=s*1.25,m=ve(t.coordinates.x),p=Math.max(14,s*1.2),w=m==="right"?s+p:-(s+p),b=m==="right"?"start":"end",j=te(),_=n.title.length>oe?`${n.title.slice(0,Math.max(0,oe))}...`:n.title,z=n.isHovered||le===n.id||mt===n.id?1:.92,W=Pe[n.type]??Bt,L=Math.max(1.5,s*.22),C=`M 0 0 L ${c} ${-u} Q 0 ${a} ${-c} ${-u} Z`;return e.jsxs("g",{className:"map-cluster",transform:`translate(${t.coordinates.x}, ${t.coordinates.y})`,opacity:z,style:{cursor:"pointer",transition:"opacity 0.2s ease"},onClick:H=>qt(n,H),onMouseEnter:()=>Kt(n),onMouseLeave:()=>Kt(null),onTouchEnd:H=>{H.stopPropagation(),H.preventDefault(),qt(n,void 0,!0)},children:[e.jsx("path",{d:C,fill:l,stroke:"white",strokeWidth:L,strokeLinejoin:"round"}),e.jsx("circle",{cx:0,cy:r,r:s,fill:l,stroke:"white",strokeWidth:L}),e.jsx("circle",{cx:0,cy:r,r:d,fill:"white",opacity:.95}),e.jsx("g",{transform:`translate(${-h/2}, ${r-h/2})`,style:{pointerEvents:"none"},children:e.jsx(W,{size:h,color:l,strokeWidth:2})}),ee()&&e.jsx("text",{x:w,y:r,className:"map-text",fontSize:j,fill:"#1f2937",textAnchor:b,dominantBaseline:"middle",style:{cursor:"pointer",fontWeight:600,paintOrder:"stroke",stroke:"white",strokeWidth:.8},children:_})]},t.id)}return e.jsxs("g",{className:"map-cluster",children:[e.jsx("circle",{cx:t.coordinates.x,cy:t.coordinates.y,r:J(12),fill:"#6366f1",stroke:"white",strokeWidth:3,opacity:.9,style:{cursor:"pointer",transition:"opacity 0.2s ease"},onClick:n=>wt(t,n),onMouseEnter:n=>{n.currentTarget.style.opacity="1"},onMouseLeave:n=>{n.currentTarget.style.opacity="0.9"},onTouchEnd:n=>{n.stopPropagation(),n.preventDefault(),wt(t)}}),ee()&&e.jsx("text",{x:t.coordinates.x,y:t.coordinates.y,className:"map-cluster-text",fontSize:te()*.8,fill:"white",textAnchor:"middle",dominantBaseline:"central",fontWeight:"bold",onClick:n=>wt(t,n),onTouchEnd:n=>{n.stopPropagation(),n.preventDefault(),wt(t)},style:{cursor:"pointer",pointerEvents:"auto"},children:t.count})]},t.id)})}),v&&e.jsxs("g",{children:[e.jsxs("circle",{cx:v.x,cy:v.y,r:J(25),fill:"#8b5cf6",opacity:"0.3",children:[e.jsx("animate",{attributeName:"r",values:`${J(20)};${J(35)};${J(20)}`,dur:"2s",repeatCount:"indefinite"}),e.jsx("animate",{attributeName:"opacity",values:"0.3;0.1;0.3",dur:"2s",repeatCount:"indefinite"})]}),e.jsx("circle",{cx:v.x,cy:v.y,r:J(16),fill:"#8b5cf6",stroke:"white",strokeWidth:4,opacity:"1"}),e.jsx("circle",{cx:v.x,cy:v.y,r:J(8),fill:"white",opacity:"0.9"})]})]}),G&&G.contentItem&&e.jsxs("div",{className:"map-card-overlay pointer-events-auto absolute z-30",style:{left:`${lt.x}px`,top:`${lt.y}px`,transform:lt.transform||"translate(-50%, -50%)",width:"300px"},children:[mt===G.id&&e.jsx("div",{className:"absolute -top-2 -right-2 z-10 rounded-full bg-blue-500 px-2 py-1 text-xs text-white shadow-lg",style:{fontSize:"10px"},children:"タップで詳細へ"}),e.jsx("div",{className:`overflow-hidden rounded-lg shadow-xl ${mt===G.id?"ring-opacity-50 ring-2 ring-blue-500":""}`,style:{minHeight:"200px",width:"100%"},children:e.jsx(se,{item:G.contentItem,variant:"compact",showTags:!0,showDescription:!0})})]}),q&&q.length>0&&e.jsx("div",{className:"map-card-overlay pointer-events-auto absolute z-30",style:{left:`${lt.x}px`,maxHeight:"500px",top:`${lt.y}px`,transform:lt.transform||"translate(-50%, -50%)",width:"400px"},children:e.jsxs("div",{className:"overflow-hidden rounded-lg bg-white/90 shadow-xl",style:{width:"100%"},children:[e.jsx("div",{className:"bg-gradient-to-r from-indigo-500 to-purple-600 p-3 text-white",children:e.jsxs("h3",{className:"text-sm font-semibold",children:[q.length,"件のコンテンツ"]})}),e.jsx("div",{className:"max-h-96 space-y-2 overflow-y-auto p-2",children:q.filter(t=>t.contentItem).map((t,n)=>e.jsx("div",{className:"overflow-hidden rounded-lg border border-gray-100",children:e.jsx(se,{item:t.contentItem,variant:"compact",showTags:!1,showDescription:!1,className:"border-0"})},`${t.id}-${n}`))})]})})]})]})};function Ve(M){switch(M){case"event":return"#405de6";case"exhibit":return"#8b5cf6";case"stall":return"#fcaf45";default:return"#6b7280"}}export{Ge as V};
