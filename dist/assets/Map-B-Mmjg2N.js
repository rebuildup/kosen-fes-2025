import{a as b,j as e,S as C,I as L,u as k,r as l,e as S,f as M,s as I}from"./index-D9gY33_V.js";import{S as T}from"./SelectedTags-CWKKpgxA.js";import{T as H}from"./TagFilter-DbI4vBzz.js";import{U as E,a as z}from"./UnifiedCard-BPawq0gZ.js";import{V as A}from"./VectorMap-D454Jlwt.js";const U=({getItemsForLocation:r,hoveredLocation:v,locations:p,onLocationHover:m,onLocationSelect:g,selectedLocation:f})=>{const{t:u}=b(),x=[...p].sort((o,t)=>{const n=r(o).length,a=r(t).length;return n!==a?a-n:o.localeCompare(t)});return e.jsxs("div",{className:"rounded-lg border border-white/20 bg-white/10 p-6",style:{backgroundColor:"var(--color-bg-secondary)"},children:[e.jsxs("h2",{className:"mb-6 flex items-center gap-2 text-xl font-semibold",style:{color:"var(--color-text-primary)"},children:[u("map.viewLocations")," (",x.length,")"]}),x.length===0?e.jsx("div",{className:"py-8 text-center",style:{color:"var(--color-text-secondary)"},children:u("map.noLocations")}):e.jsx("div",{className:"scrollbar-thin overflow-x-auto",children:e.jsx("div",{className:"flex gap-4 pb-4",style:{minWidth:"max-content"},children:x.map(o=>{const t=r(o),n=t[0];return n?e.jsx("div",{className:"w-80 flex-shrink-0",onMouseEnter:()=>m(o),onMouseLeave:()=>m(null),onClick:()=>g(o),children:e.jsxs("div",{className:"relative",children:[e.jsx(E,{item:n,variant:"default",showTags:!1,showDescription:!1,showAnimation:!0}),e.jsxs("div",{className:"absolute top-2 left-2 rounded-lg bg-black/80 px-3 py-1 text-white",children:[e.jsx("div",{className:"text-sm font-semibold",children:o}),e.jsxs("div",{className:"text-xs opacity-80",children:[t.length," ",(t.length===1,"項目")]})]}),e.jsx("div",{className:"absolute right-2 bottom-2 rounded-lg bg-black/80 px-2 py-1",children:e.jsx("div",{className:"text-xs text-white",children:(()=>{const a=t.filter(i=>i.type==="event").length,c=t.filter(i=>i.type==="exhibit").length,h=t.filter(i=>i.type==="stall").length;return e.jsxs("div",{className:"flex items-center gap-3",children:[a>0&&e.jsxs("div",{className:"flex items-center gap-1","aria-label":`${a} イベント`,children:[e.jsx(C,{size:14}),e.jsx("span",{className:"text-xs text-white",children:a})]}),c>0&&e.jsxs("div",{className:"flex items-center gap-1","aria-label":`${c} 展示`,children:[e.jsx(L,{size:14}),e.jsx("span",{className:"text-xs text-white",children:c})]}),h>0&&e.jsxs("div",{className:"flex items-center gap-1","aria-label":`${h} 出店`,children:[e.jsx(z,{size:14}),e.jsx("span",{className:"text-xs text-white",children:h})]})]})})()})})]})},o):null})})})]})},Z=r=>r.type==="event"||r.type==="exhibit"||r.type==="stall",D=()=>{const{t:r}=b(),{filterItemsByTags:v,selectedTags:p}=k(),m="70vh",[g,f]=l.useState(null),[u,x]=l.useState(null),o=l.useMemo(()=>S.filter(s=>s.showOnMap),[]),t=l.useMemo(()=>[...o,...M,...I],[o]),n=l.useMemo(()=>[...new Set(t.map(s=>s.location))],[t]),a=l.useMemo(()=>p.length===0?t:v(t).filter(Z),[t,p,v]),c=l.useMemo(()=>{const s={};for(const d of n){const j=a.filter(w=>w.location===d);j.length>0&&(s[d]=j)}return s},[n,a]),h=l.useCallback(s=>{f(s)},[]),i=l.useCallback(s=>{x(d=>s===d?null:s)},[]),y=l.useCallback(s=>a.filter(d=>d.location===s),[a]),N=l.useMemo(()=>Object.keys(c),[c]);return e.jsx("div",{className:"min-h-screen",children:e.jsxs("section",{className:"section py-8",style:{backgroundColor:"var(--color-bg-primary)"},children:[e.jsxs("div",{className:"mx-auto max-w-7xl",children:[e.jsx("div",{className:"mb-8",children:e.jsx("h1",{className:"text-3xl font-bold",style:{color:"var(--color-text-primary)"},children:r("map.title")})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx(H,{compact:!0}),e.jsx(T,{})]}),e.jsx("div",{className:"w-full",children:e.jsxs("div",{className:"relative overflow-hidden rounded-lg",style:{backgroundColor:"var(--color-bg-secondary)"},children:[e.jsx("div",{className:"border-b p-4",style:{borderColor:"var(--color-border-primary)"},children:e.jsx("h2",{className:"flex items-center gap-2 text-xl font-semibold",style:{color:"var(--color-text-primary)"},children:"会場マップ"})}),e.jsx("div",{className:"relative",children:e.jsx("div",{className:"map-container relative m-4",style:{backgroundColor:"var(--color-bg-secondary)",borderColor:"var(--color-border-primary)",minHeight:m},children:e.jsx(A,{mode:"display",points:a.filter(s=>s.coordinates).map(s=>({contentItem:s,coordinates:s.coordinates,id:s.id,isHovered:!1,isSelected:!1,onClick:()=>{},onHover:()=>{},title:s.title,type:s.type})),height:m,className:"rounded-lg",maxZoom:8,minZoom:.3,showControls:!0,initialZoom:2})})})]})})]})]}),e.jsx("div",{className:"mt-6",children:e.jsx(U,{locations:N,getItemsForLocation:y,onLocationSelect:i,onLocationHover:h,hoveredLocation:g,selectedLocation:u})})]})})};export{D as default};
