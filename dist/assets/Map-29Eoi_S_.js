import{a as C,j as e,u as T,r as s,e as L,c as w,s as k}from"./index-BJL_EZoJ.js";import{V as F}from"./VectorMap-DW-nEMDb.js";import{U as M}from"./UnifiedCard-DXTFbBXX.js";import{T as B}from"./TagFilter-CLUq6USV.js";import{S as E}from"./SelectedTags-DH40keFI.js";const H=({locations:a,getItemsForLocation:u,hoveredLocation:n,selectedLocation:d,onLocationHover:p,onLocationSelect:b})=>{const{t:v}=C(),m=[...a].sort();return e.jsxs("div",{className:"rounded-lg p-6 backdrop-blur-md bg-white/10 border border-white/20",style:{backgroundColor:"var(--color-bg-secondary)"},children:[e.jsxs("h2",{className:"text-xl font-semibold mb-6 flex items-center gap-2",style:{color:"var(--color-text-primary)"},children:[v("map.viewLocations")," (",m.length,")"]}),m.length===0?e.jsx("div",{className:"text-center py-8",style:{color:"var(--color-text-secondary)"},children:v("map.noLocations")}):e.jsx("div",{className:"overflow-x-auto",children:e.jsx("div",{className:"flex gap-4 pb-4",style:{minWidth:"max-content"},children:m.map(o=>{const l=u(o),g=l[0];return g?e.jsx("div",{className:`
                    flex-shrink-0 w-72 transition-all duration-200
                    ${n===o?"ring-2 ring-white/50 rounded-lg":""}
                    ${d===o?"ring-2 ring-white/80 rounded-lg":""}
                  `,onMouseEnter:()=>p(o),onMouseLeave:()=>p(null),onClick:()=>b(o),children:e.jsxs("div",{className:"relative",children:[e.jsx(M,{item:g,variant:"compact",showTags:!1,showDescription:!1}),e.jsxs("div",{className:"absolute top-2 left-2 bg-black/80 backdrop-blur-sm rounded-lg px-3 py-1 text-white",children:[e.jsx("div",{className:"text-sm font-semibold",children:o}),e.jsxs("div",{className:"text-xs opacity-80",children:[l.length," ",(l.length===1,"項目")]})]}),e.jsx("div",{className:"absolute bottom-2 right-2 bg-black/80 backdrop-blur-sm rounded-lg px-2 py-1",children:e.jsx("div",{className:"text-xs text-white",children:(()=>{const h=l.filter(r=>r.type==="event").length,x=l.filter(r=>r.type==="exhibit").length,f=l.filter(r=>r.type==="stall").length,c=[];return h>0&&c.push(`🎭${h}`),x>0&&c.push(`🏛️${x}`),f>0&&c.push(`🍕${f}`),c.join(" ")})()})})]})},o):null})})})]})},$=a=>a.type==="event"||a.type==="exhibit"||a.type==="stall",A=()=>{const{t:a}=C(),{filterItemsByTags:u,selectedTags:n}=T(),[d,p]=s.useState([]),[b,v]=s.useState(null),[m,o]=s.useState(null),[l,g]=s.useState({}),h=s.useMemo(()=>[...new Set([...L,...w,...k].map(t=>t.location))],[]),x=s.useCallback(t=>n.length===0?t:u(t),[n,u]);s.useEffect(()=>{const t=[...L,...w,...k];let i=t;n.length>0&&(i=x(t).filter($)),p(i);const j={};h.forEach(y=>{const N=i.filter(S=>S.location===y);N.length>0&&(j[y]=N)}),g(j)},[n,x,h]);const f=s.useCallback(t=>{v(t)},[]),c=s.useCallback(t=>{o(i=>t===i?null:t)},[]),r=s.useCallback(t=>d.filter(i=>i.location===t),[d]),I=s.useMemo(()=>Object.keys(l),[l]);return e.jsx("div",{className:"min-h-screen",children:e.jsxs("section",{className:"section py-8",style:{backgroundColor:"var(--color-bg-primary)"},children:[e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsx("div",{className:"mb-8",children:e.jsx("h1",{className:"text-3xl font-bold",style:{color:"var(--color-text-primary)"},children:a("map.title")})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx(B,{onFilter:()=>{},compact:!0}),e.jsx(E,{})]}),e.jsx("div",{className:"w-full",children:e.jsxs("div",{className:"rounded-lg overflow-hidden relative",style:{backgroundColor:"var(--color-bg-secondary)"},children:[e.jsx("div",{className:"p-4 border-b",style:{borderColor:"var(--color-border-primary)"},children:e.jsx("h2",{className:"text-xl font-semibold flex items-center gap-2",style:{color:"var(--color-text-primary)"},children:"会場マップ"})}),e.jsx("div",{className:"relative",children:e.jsx("div",{className:"map-container relative w-full",style:{minHeight:"70vh"},children:e.jsx(F,{mode:"display",points:d.filter(t=>t.coordinates).map(t=>({id:t.id,coordinates:t.coordinates,title:t.title,type:t.type,isSelected:!1,isHovered:!1,contentItem:t,onClick:()=>{},onHover:()=>{}})),height:"70vh",className:"rounded-lg",maxZoom:8,minZoom:.3,showControls:!0,initialZoom:2})})})]})})]})]}),e.jsx("div",{className:"mt-6",children:e.jsx(H,{locations:I,getItemsForLocation:r,onLocationSelect:c,onLocationHover:f,hoveredLocation:b,selectedLocation:m})})]})})};export{A as default};
