import{a as e,h as s,j as t,u as a,b as r,e as l,c as n,s as c,g as i}from"./index-B4ZMLk0T.js";import{u as o,r as x,c as d}from"./react-DptwHfsC.js";import{d as m,S as h,I as u,f as p}from"./ui-9eKVU0xZ.js";import{T as g}from"./TagFilter-C1CdAU1t.js";import{C as v,a as b}from"./CardListToggle-Hf52dTY7.js";import{p as f}from"./random-CAJgswxN.js";import"./animation-BGH1bKEe.js";import"./UnifiedCard-1mNeO77I.js";const j=({autoFocus:a=!1,className:r="",placeholder:l,showSuggestions:n=!1,variant:c="default"})=>{const{t:i}=e(),{performSearch:d,recentSearches:h,searchQuery:u,setSearchQuery:p}=s(),g=o(),[v,b]=x.useState(u),[f,j]=x.useState(!1),[y,N]=x.useState(-1),w=x.useRef(null),k=x.useRef(null),T=x.useRef(null);x.useEffect(()=>{a&&w.current&&w.current.focus()},[a]),x.useEffect(()=>{b(u)},[u]);const S=e=>{e.preventDefault(),v.trim()&&(d(v.trim()),g(`/search?q=${encodeURIComponent(v.trim())}`),j(!1),setTimeout(()=>{w.current&&w.current.focus()},0))},C=e=>{b(e),p(e),d(e),g(`/search?q=${encodeURIComponent(e)}`),j(!1),setTimeout(()=>{w.current&&w.current.focus()},0)},$=()=>{b(""),p(""),j(!1),globalThis.location.hash.includes("/search")&&g("/search",{replace:!0}),w.current&&w.current.focus()},D=n?h:[];return t.jsxs("div",{className:`relative w-full ${r}`,children:[t.jsx("div",{ref:k,className:(()=>{const e=`group relative flex w-full items-center gap-3 ${f?"rounded-t-3xl":"rounded-full"} border border-(--border-color) bg-(--bg-secondary) px-4 shadow-sm transition-all duration-200`;switch(c){case"large":return`${e} h-12`;case"inline":return`${e} h-9`;default:return`${e} h-10`}})(),children:t.jsxs("form",{onSubmit:S,className:"flex w-full items-center gap-2","aria-label":i("actions.search"),children:[t.jsx(m,{size:(()=>{switch(c){case"large":return 24;case"inline":return 16;default:return 20}})(),className:"shrink-0 text-(--text-secondary)"}),t.jsx("input",{ref:w,type:"search",value:v,onChange:e=>{const s=e.target.value;b(s),N(-1),n&&s.trim()?j(!0):j(!1)},onKeyDown:e=>{if("Escape"===e.key&&!f)return void $();if(!f)return;const s=h;switch(e.key){case"ArrowDown":e.preventDefault(),N(e=>e<s.length-1?e+1:e);break;case"ArrowUp":e.preventDefault(),N(e=>e>0?e-1:e);break;case"Enter":e.preventDefault(),y>=0&&s[y]?C(s[y]):S(e);break;case"Escape":j(!1),N(-1)}},onFocus:()=>{n&&h.length>0&&j(!0)},onBlur:e=>{setTimeout(()=>{var s;(null==(s=T.current)?void 0:s.contains(e.relatedTarget))||e.relatedTarget===w.current||(j(!1),N(-1))},150)},placeholder:l||i("search.placeholder"),className:`peer w-full border-0 bg-transparent py-0 leading-tight ${(()=>{switch(c){case"large":return"text-base";case"inline":return"text-xs";default:return"text-sm"}})()} text-sm placeholder-(--text-secondary) outline-none`,autoComplete:"off","aria-label":i("search.placeholder"),"aria-haspopup":"listbox"}),v.trim()&&t.jsx("button",{type:"button",onClick:$,className:"rounded-full p-1.5 text-(--text-secondary) transition-all duration-200 hover:bg-(--bg-primary) hover:text-(--text-primary)","aria-label":i("actions.clear"),title:i("actions.clear"),children:t.jsxs("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:[t.jsx("title",{children:"Icon"}),t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})]})})]})}),f&&D.length>0&&t.jsx("div",{ref:T,className:"absolute top-full right-0 left-0 z-50 -mt-px max-h-64 overflow-y-auto rounded-b-3xl border border-t-0 border-(--border-color) bg-(--bg-secondary) shadow-sm",children:t.jsx("div",{className:"py-2",role:"presentation","aria-label":i("search.suggestions"),children:D.map((e,s)=>t.jsxs("button",{type:"button",onClick:()=>C(e),className:"flex w-full items-center gap-3 px-4 py-2.5 text-left transition-all duration-200 "+(y===s?"bg-(--bg-tertiary) text-(--primary-color)":"text-(--text-primary) hover:bg-(--bg-primary)"),"aria-selected":y===s,children:[t.jsx(m,{size:16,className:"text-(--text-secondary)"}),t.jsx("span",{className:"flex-1",children:e}),t.jsx("span",{className:"text-xs text-(--text-secondary)",children:i("search.recentSearches")})]},e))})})]})};function y(e,s){if(!s.trim()||!e)return t.jsx(t.Fragment,{children:e});try{const a=e.split(new RegExp(`(${s})`,"gi"));return t.jsx(t.Fragment,{children:a.map((e,a)=>e.toLowerCase()===s.toLowerCase()?t.jsx("mark",{className:"rounded bg-gradient-to-r from-[var(--accent-yellow)] to-[var(--accent-orange)] px-1 text-[var(--text-primary)]",children:e},`highlight-${a}-${e.slice(0,10)}`):e)})}catch(a){return t.jsx(t.Fragment,{children:e})}}const N=()=>{const{isSearching:l,searchQuery:n,searchResults:c}=s(),{t:i}=e(),{selectedTags:o}=a(),{filterByTags:d}=r(),[m,g]=x.useState("default"),[f,j]=x.useState({events:[],exhibits:[],stalls:[]}),N=x.useCallback(e=>0===o.length?e:e.filter(e=>o.every(s=>{var t;return null==(t=e.tags)?void 0:t.includes(s)})),[o]);x.useEffect(()=>{const e=n.trim();let s=c;e||(s=o.length>0?d(o):[]);const t=o.length>0?N(s):s,a={events:[],exhibits:[],stalls:[]};for(const r of t)switch(r.type){case"event":a.events.push(r);break;case"exhibit":a.exhibits.push(r);break;case"stall":a.stalls.push(r)}j(a)},[c,N,o,n,d]);const w=f.events.length+f.exhibits.length+f.stalls.length;return l?t.jsxs("div",{className:"py-12 text-center",children:[t.jsx("div",{className:"mx-auto mb-4 h-8 w-8 animate-spin rounded-full border-4 border-[var(--primary-color)] border-t-transparent"}),t.jsx("span",{className:"text-[var(--text-secondary)]",children:i("search.searching")})]}):n||0!==o.length?0===w?t.jsxs("div",{className:"py-12 text-center",children:[t.jsx("h2",{className:"mb-2 text-xl font-semibold text-[var(--text-primary)]",children:i("search.noResults")}),t.jsx("p",{className:"text-[var(--text-secondary)]",children:i("search.tryDifferentKeywords")})]}):t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex flex-col items-start justify-between gap-4 rounded-xl border border-[var(--border-color)] bg-[var(--bg-secondary)] p-6 sm:flex-row sm:items-center",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("h2",{className:"text-xl font-semibold text-[var(--text-primary)]",children:i("search.results")}),w>0&&t.jsxs("span",{className:"rounded-full bg-[var(--primary-color)] px-3 py-1 text-sm font-medium text-white",children:[w," ",i("search.items")]})]}),t.jsx(v,{viewMode:m,setViewMode:g})]}),t.jsxs("div",{className:"space-y-8",children:[f.events.length>0&&t.jsxs("section",{className:"space-y-4",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"h-8 w-1 rounded-full",style:{background:"linear-gradient(to bottom, var(--accent-purple), var(--accent-pink))"}}),t.jsx(h,{size:24,style:{color:"var(--accent-purple)"}}),t.jsx("h3",{className:"text-xl font-semibold text-[var(--text-primary)]",children:i("navigation.events")}),t.jsx("div",{className:"h-px flex-1 bg-[var(--border-color)]"}),t.jsxs("span",{className:"rounded-full bg-[var(--bg-secondary)] px-3 py-1 text-sm text-[var(--text-secondary)]",children:[f.events.length," ",i("search.items")]})]}),t.jsx("div",{className:"rounded-xl bg-[var(--bg-secondary)] p-6",children:t.jsx(b,{items:f.events,variant:m,showTags:!0,showDescription:"list"===m,highlightText:e=>y(e,n),emptyMessage:i("events.noEventsFound"),filterType:"all"})})]},"events-section"),f.exhibits.length>0&&t.jsxs("section",{className:"space-y-4",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"h-8 w-1 rounded-full",style:{background:"linear-gradient(to bottom, var(--accent-blue), var(--accent-teal))"}}),t.jsx(u,{size:24,style:{color:"var(--accent-blue)"}}),t.jsx("h3",{className:"text-xl font-semibold text-[var(--text-primary)]",children:i("exhibits.filters.exhibits")}),t.jsx("div",{className:"h-px flex-1 bg-[var(--border-color)]"}),t.jsxs("span",{className:"rounded-full bg-[var(--bg-secondary)] px-3 py-1 text-sm text-[var(--text-secondary)]",children:[f.exhibits.length," ",i("search.items")]})]}),t.jsx("div",{className:"rounded-xl bg-[var(--bg-secondary)] p-6",children:t.jsx(b,{items:f.exhibits,variant:m,showTags:!0,showDescription:"list"===m,highlightText:e=>y(e,n),emptyMessage:i("exhibits.noExhibits"),filterType:"all"})})]},"exhibits-section"),f.stalls.length>0&&t.jsxs("section",{className:"space-y-4",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"h-8 w-1 rounded-full",style:{background:"linear-gradient(to bottom, var(--accent-orange), var(--accent-red))"}}),t.jsx(p,{size:24,style:{color:"var(--accent-orange)"}}),t.jsx("h3",{className:"text-xl font-semibold text-[var(--text-primary)]",children:i("exhibits.filters.stalls")}),t.jsx("div",{className:"h-px flex-1 bg-[var(--border-color)]"}),t.jsxs("span",{className:"rounded-full bg-[var(--bg-secondary)] px-3 py-1 text-sm text-[var(--text-secondary)]",children:[f.stalls.length," ",i("search.items")]})]}),t.jsx("div",{className:"rounded-xl bg-[var(--bg-secondary)] p-6",children:t.jsx(b,{items:f.stalls,variant:m,showTags:!0,showDescription:"list"===m,highlightText:e=>y(e,n),emptyMessage:i("exhibits.noStalls"),filterType:"all"})})]},"stalls-section")]})]}):t.jsx("div",{className:"py-12 text-center text-[var(--text-secondary)]",children:t.jsx("p",{children:i("search.searchPrompt")})})},w=l,k=n,T=i,S=c,C=e=>e.replace(/^\.?\/?images\//,"./images/"),$=()=>{const{performSearch:r,searchQuery:l,searchResults:n,setSearchQuery:c}=s(),{selectedTags:i}=a(),{t:o}=e(),m=d(),h=x.useMemo(()=>function(){const e=[...w.map(e=>e.imageUrl),...k.map(e=>e.imageUrl),...S.map(e=>e.imageUrl),...T.map(e=>e.imageUrl)].filter(Boolean).map(C);return f(e)||""}(),[]),u=l.trim().length>0||i.length>0||n.length>0;return x.useEffect(()=>{const e=new URLSearchParams(m.search).get("q");e&&e!==l&&(c(e),r(e))},[m.search,l,c,r]),t.jsxs("div",{className:"min-h-screen bg-[var(--bg-primary)]",children:[t.jsxs("section",{className:"relative overflow-hidden py-16",children:[t.jsx("img",{src:h,className:"pointer-events-none absolute inset-0 z-0 h-full w-full object-cover opacity-20",alt:"","aria-hidden":"true"}),t.jsx("div",{className:"absolute inset-0 opacity-10",style:{background:"var(--instagram-gradient)"}}),t.jsx("div",{className:"relative mx-auto max-w-7xl px-4 sm:px-6 lg:px-8",children:t.jsxs("div",{className:"text-center",children:[!u&&t.jsxs(t.Fragment,{children:[t.jsx("h1",{className:"mb-4 text-4xl font-bold text-[var(--text-primary)] md:text-5xl",children:o("search.title")}),t.jsx("p",{className:"mx-auto mb-8 max-w-2xl text-xl text-[var(--text-secondary)]",children:o("search.subtitle")})]}),t.jsx("div",{className:"mx-auto max-w-3xl",children:t.jsx(j,{variant:"large",autoFocus:!0,showSuggestions:!0})}),!u&&t.jsx("div",{className:"mx-auto mt-6 max-w-2xl",children:t.jsxs("div",{className:"rounded-xl border border-[var(--border-color)] bg-[var(--bg-secondary)] p-4",children:[t.jsxs("h3",{className:"mb-3 flex items-center justify-center gap-2 text-sm font-semibold text-[var(--text-primary)]",children:[t.jsx("span",{children:"💡"}),o("search.searchTips")]}),t.jsxs("div",{className:"space-y-2 text-sm text-[var(--text-secondary)]",children:[t.jsxs("div",{className:"flex items-start gap-2",children:[t.jsx("span",{className:"text-[var(--primary-color)]",children:"•"}),t.jsx("span",{children:o("search.searchInstructions.keyword")})]}),t.jsxs("div",{className:"flex items-start gap-2",children:[t.jsx("span",{className:"text-[var(--primary-color)]",children:"•"}),t.jsx("span",{children:o("search.searchInstructions.tags")})]}),t.jsxs("div",{className:"flex items-start gap-2",children:[t.jsx("span",{className:"text-[var(--primary-color)]",children:"•"}),t.jsx("span",{children:o("search.searchInstructions.location")})]})]})]})}),t.jsx("div",{className:"mx-auto mt-6 max-w-3xl",children:t.jsx(g,{compact:!1})})]})})]}),t.jsx("section",{className:"section bg-[var(--bg-primary)]",children:t.jsx("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8",children:t.jsx("div",{className:"space-y-8",children:t.jsx("div",{className:"rounded-xl bg-[var(--bg-primary)]",children:t.jsx(N,{})})})})})]})};export{$ as default};
