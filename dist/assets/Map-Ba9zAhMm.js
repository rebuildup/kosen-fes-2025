import{a as j,j as e,u as L,r as o,e as C,c as k,s as M}from"./index-DiK8qNwB.js";import{V as S}from"./VectorMap-1MSLZjGj.js";import{U as I}from"./UnifiedCard-CHoqHSgW.js";import{T}from"./TagFilter-B8_RKDbe.js";import{S as H}from"./SelectedTags-BmRa8zT5.js";const E=({locations:a,getItemsForLocation:x,hoveredLocation:p,selectedLocation:u,onLocationHover:v,onLocationSelect:f})=>{const{t:g}=j(),d=[...a].sort();return e.jsxs("div",{className:"rounded-lg p-6 bg-white/10 border border-white/20",style:{backgroundColor:"var(--color-bg-secondary)"},children:[e.jsxs("h2",{className:"text-xl font-semibold mb-6 flex items-center gap-2",style:{color:"var(--color-text-primary)"},children:[g("map.viewLocations")," (",d.length,")"]}),d.length===0?e.jsx("div",{className:"text-center py-8",style:{color:"var(--color-text-secondary)"},children:g("map.noLocations")}):e.jsx("div",{className:"overflow-x-auto scrollbar-thin",children:e.jsx("div",{className:"flex gap-4 pb-4",style:{minWidth:"max-content"},children:d.map(r=>{const t=x(r),m=t[0];return m?e.jsx("div",{className:`
                    flex-shrink-0 w-72 transition-all duration-200
                    ${p===r?"ring-2 ring-white/50 rounded-lg":""}
                    ${u===r?"ring-2 ring-white/80 rounded-lg":""}
                  `,onMouseEnter:()=>v(r),onMouseLeave:()=>v(null),onClick:()=>f(r),children:e.jsxs("div",{className:"relative",children:[e.jsx(I,{item:m,variant:"compact",showTags:!1,showDescription:!1}),e.jsxs("div",{className:"absolute top-2 left-2 bg-black/80 rounded-lg px-3 py-1 text-white",children:[e.jsx("div",{className:"text-sm font-semibold",children:r}),e.jsxs("div",{className:"text-xs opacity-80",children:[t.length," ",(t.length===1,"項目")]})]}),e.jsx("div",{className:"absolute bottom-2 right-2 bg-black/80 rounded-lg px-2 py-1",children:e.jsx("div",{className:"text-xs text-white",children:(()=>{const l=t.filter(n=>n.type==="event").length,h=t.filter(n=>n.type==="exhibit").length,b=t.filter(n=>n.type==="stall").length,i=[];return l>0&&i.push(`🎭${l}`),h>0&&i.push(`🏛️${h}`),b>0&&i.push(`🍕${b}`),i.join(" ")})()})})]})},r):null})})})]})},$=a=>a.type==="event"||a.type==="exhibit"||a.type==="stall",W=()=>{const{t:a}=j(),{filterItemsByTags:x,selectedTags:p}=L(),u="70vh",[v,f]=o.useState(null),[g,d]=o.useState(null),r=o.useMemo(()=>C.filter(s=>s.showOnMap),[]),t=o.useMemo(()=>[...r,...k,...M],[r]),m=o.useMemo(()=>[...new Set(t.map(s=>s.location))],[t]),l=o.useMemo(()=>p.length===0?t:x(t).filter($),[t,p,x]),h=o.useMemo(()=>{const s={};return m.forEach(c=>{const y=l.filter(w=>w.location===c);y.length>0&&(s[c]=y)}),s},[m,l]),b=o.useCallback(s=>{f(s)},[]),i=o.useCallback(s=>{d(c=>s===c?null:s)},[]),n=o.useCallback(s=>l.filter(c=>c.location===s),[l]),N=o.useMemo(()=>Object.keys(h),[h]);return e.jsx("div",{className:"min-h-screen",children:e.jsxs("section",{className:"section py-8",style:{backgroundColor:"var(--color-bg-primary)"},children:[e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsx("div",{className:"mb-8",children:e.jsx("h1",{className:"text-3xl font-bold",style:{color:"var(--color-text-primary)"},children:a("map.title")})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx(T,{onFilter:()=>{},compact:!0}),e.jsx(H,{})]}),e.jsx("div",{className:"w-full",children:e.jsxs("div",{className:"rounded-lg overflow-hidden relative",style:{backgroundColor:"var(--color-bg-secondary)"},children:[e.jsx("div",{className:"p-4 border-b",style:{borderColor:"var(--color-border-primary)"},children:e.jsx("h2",{className:"text-xl font-semibold flex items-center gap-2",style:{color:"var(--color-text-primary)"},children:"会場マップ"})}),e.jsx("div",{className:"relative",children:e.jsx("div",{className:"map-container relative m-4",style:{minHeight:u,backgroundColor:"var(--color-bg-secondary)",borderColor:"var(--color-border-primary)"},children:e.jsx(S,{mode:"display",points:l.filter(s=>s.coordinates).map(s=>({id:s.id,coordinates:s.coordinates,title:s.title,type:s.type,isSelected:!1,isHovered:!1,contentItem:s,onClick:()=>{},onHover:()=>{}})),height:u,className:"rounded-lg",maxZoom:8,minZoom:.3,showControls:!0,initialZoom:2})})})]})})]})]}),e.jsx("div",{className:"mt-6",children:e.jsx(E,{locations:N,getItemsForLocation:n,onLocationSelect:i,onLocationHover:b,hoveredLocation:v,selectedLocation:g})})]})})};export{W as default};
