import{a as e,h as s,j as a,u as t,b as r,e as l,c,s as n,g as i}from"./index-DM_eUdx6.js";import{u as o,r as x,c as d}from"./react-BiDznpw8.js";import{d as m,S as h,I as u,f as p}from"./ui-DfargGwq.js";import{T as v}from"./TagFilter-DWi7dvCK.js";import{C as g,a as b}from"./CardListToggle-jjDMAZYf.js";import{p as f}from"./random-CAJgswxN.js";import"./animation-BGH1bKEe.js";import"./UnifiedCard-sA-Cpset.js";const j=({autoFocus:t=!1,className:r="",placeholder:l,showSuggestions:c=!1,variant:n="default"})=>{const{t:i}=e(),{performSearch:d,recentSearches:h,searchQuery:u,setSearchQuery:p}=s(),v=o(),[g,b]=x.useState(u),[f,j]=x.useState(!1),[y,N]=x.useState(-1),w=x.useRef(null),k=x.useRef(null),T=x.useRef(null);x.useEffect(()=>{t&&w.current&&w.current.focus()},[t]),x.useEffect(()=>{b(u)},[u]);const S=e=>{e.preventDefault(),g.trim()&&(d(g.trim()),v(`/search?q=${encodeURIComponent(g.trim())}`),j(!1),setTimeout(()=>{w.current&&w.current.focus()},0))},C=e=>{b(e),p(e),d(e),v(`/search?q=${encodeURIComponent(e)}`),j(!1),setTimeout(()=>{w.current&&w.current.focus()},0)},$=()=>{b(""),p(""),j(!1),globalThis.location.hash.includes("/search")&&v("/search",{replace:!0}),w.current&&w.current.focus()},D=c?h:[];return a.jsxs("div",{className:`relative w-full ${r}`,children:[a.jsx("div",{ref:k,className:(()=>{const e=`group relative flex w-full items-center gap-3 ${f?"rounded-t-3xl":"rounded-full"} border border-[var(--border-color)] bg-[var(--bg-secondary)] px-4 shadow-sm transition-all duration-200`;switch(n){case"large":return`${e} h-12`;case"inline":return`${e} h-9`;default:return`${e} h-10`}})(),children:a.jsxs("form",{onSubmit:S,className:"flex w-full items-center gap-2","aria-label":i("actions.search"),children:[a.jsx(m,{size:(()=>{switch(n){case"large":return 24;case"inline":return 16;default:return 20}})(),className:"shrink-0 text-[var(--text-secondary)]"}),a.jsx("input",{ref:w,type:"search",value:g,onChange:e=>{const s=e.target.value;b(s),N(-1),c&&s.trim()?j(!0):j(!1)},onKeyDown:e=>{if("Escape"===e.key&&!f)return void $();if(!f)return;const s=h;switch(e.key){case"ArrowDown":e.preventDefault(),N(e=>e<s.length-1?e+1:e);break;case"ArrowUp":e.preventDefault(),N(e=>e>0?e-1:e);break;case"Enter":e.preventDefault(),y>=0&&s[y]?C(s[y]):S(e);break;case"Escape":j(!1),N(-1)}},onFocus:()=>{c&&h.length>0&&j(!0)},onBlur:e=>{setTimeout(()=>{var s;(null==(s=T.current)?void 0:s.contains(e.relatedTarget))||e.relatedTarget===w.current||(j(!1),N(-1))},150)},placeholder:l||i("search.placeholder"),className:`peer w-full border-0 bg-transparent py-0 leading-tight ${(()=>{switch(n){case"large":return"text-base";case"inline":return"text-xs";default:return"text-sm"}})()} text-sm placeholder-[var(--text-secondary)] outline-none`,autoComplete:"off","aria-label":i("search.placeholder"),"aria-haspopup":"listbox"}),g.trim()&&a.jsx("button",{type:"button",onClick:$,className:"rounded-full p-1.5 text-[var(--text-secondary)] transition-all duration-200 hover:bg-[var(--bg-primary)] hover:text-[var(--text-primary)]","aria-label":i("actions.clear"),title:i("actions.clear"),children:a.jsxs("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:[a.jsx("title",{children:"Icon"}),a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})]})})]})}),f&&D.length>0&&a.jsx("div",{ref:T,className:"absolute top-full right-0 left-0 z-50 -mt-px max-h-64 overflow-y-auto rounded-b-3xl border border-t-0 border-[var(--border-color)] bg-[var(--bg-secondary)] shadow-sm",children:a.jsx("div",{className:"py-2",role:"listbox","aria-label":i("search.suggestions"),children:D.map((e,s)=>a.jsxs("button",{type:"button",onClick:()=>C(e),className:"flex w-full items-center gap-3 px-4 py-2.5 text-left transition-all duration-200 "+(y===s?"bg-[var(--bg-tertiary)] text-[var(--primary-color)]":"text-[var(--text-primary)] hover:bg-[var(--bg-primary)]"),role:"option","aria-selected":y===s,children:[a.jsx(m,{size:16,className:"text-[var(--text-secondary)]"}),a.jsx("span",{className:"flex-1",children:e}),a.jsx("span",{className:"text-xs text-[var(--text-secondary)]",children:i("search.recentSearches")})]},e))})})]})};function y(e,s){if(!s.trim()||!e)return a.jsx(a.Fragment,{children:e});try{const t=e.split(new RegExp(`(${s})`,"gi"));return a.jsx(a.Fragment,{children:t.map((e,t)=>e.toLowerCase()===s.toLowerCase()?a.jsx("mark",{className:"rounded bg-gradient-to-r from-[var(--accent-yellow)] to-[var(--accent-orange)] px-1 text-[var(--text-primary)]",children:e},`highlight-${t}-${e.slice(0,10)}`):e)})}catch(t){return a.jsx(a.Fragment,{children:e})}}const N=()=>{const{isSearching:l,searchQuery:c,searchResults:n}=s(),{t:i}=e(),{selectedTags:o}=t(),{filterByTags:d}=r(),[m,v]=x.useState("default"),[f,j]=x.useState({events:[],exhibits:[],stalls:[]}),N=x.useCallback(e=>0===o.length?e:e.filter(e=>o.every(s=>{var a;return null==(a=e.tags)?void 0:a.includes(s)})),[o]);x.useEffect(()=>{const e=c.trim();let s=n;e||(s=o.length>0?d(o):[]);const a=o.length>0?N(s):s,t={events:[],exhibits:[],stalls:[]};for(const r of a)switch(r.type){case"event":t.events.push(r);break;case"exhibit":t.exhibits.push(r);break;case"stall":t.stalls.push(r)}j(t)},[n,N,o,c,d]);const w=f.events.length+f.exhibits.length+f.stalls.length;return l?a.jsxs("div",{className:"py-12 text-center",children:[a.jsx("div",{className:"mx-auto mb-4 h-8 w-8 animate-spin rounded-full border-4 border-[var(--primary-color)] border-t-transparent"}),a.jsx("span",{className:"text-[var(--text-secondary)]",children:i("search.searching")})]}):c||0!==o.length?0===w?a.jsxs("div",{className:"py-12 text-center",children:[a.jsx("h2",{className:"mb-2 text-xl font-semibold text-[var(--text-primary)]",children:i("search.noResults")}),a.jsx("p",{className:"text-[var(--text-secondary)]",children:i("search.tryDifferentKeywords")})]}):a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex flex-col items-start justify-between gap-4 rounded-xl border border-[var(--border-color)] bg-[var(--bg-secondary)] p-6 sm:flex-row sm:items-center",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("h2",{className:"text-xl font-semibold text-[var(--text-primary)]",children:i("search.results")}),w>0&&a.jsxs("span",{className:"rounded-full bg-[var(--primary-color)] px-3 py-1 text-sm font-medium text-white",children:[w," ",i("search.items")]})]}),a.jsx(g,{viewMode:m,setViewMode:v})]}),a.jsxs("div",{className:"space-y-8",children:[f.events.length>0&&a.jsxs("section",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"h-8 w-1 rounded-full",style:{background:"linear-gradient(to bottom, var(--accent-purple), var(--accent-pink))"}}),a.jsx(h,{size:24,style:{color:"var(--accent-purple)"}}),a.jsx("h3",{className:"text-xl font-semibold text-[var(--text-primary)]",children:i("navigation.events")}),a.jsx("div",{className:"h-px flex-1 bg-[var(--border-color)]"}),a.jsxs("span",{className:"rounded-full bg-[var(--bg-secondary)] px-3 py-1 text-sm text-[var(--text-secondary)]",children:[f.events.length," ",i("search.items")]})]}),a.jsx("div",{className:"rounded-xl bg-[var(--bg-secondary)] p-6",children:a.jsx(b,{items:f.events,variant:m,showTags:!0,showDescription:"list"===m,highlightText:e=>y(e,c),emptyMessage:i("events.noEventsFound"),filterType:"all"})})]},"events-section"),f.exhibits.length>0&&a.jsxs("section",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"h-8 w-1 rounded-full",style:{background:"linear-gradient(to bottom, var(--accent-blue), var(--accent-teal))"}}),a.jsx(u,{size:24,style:{color:"var(--accent-blue)"}}),a.jsx("h3",{className:"text-xl font-semibold text-[var(--text-primary)]",children:i("exhibits.filters.exhibits")}),a.jsx("div",{className:"h-px flex-1 bg-[var(--border-color)]"}),a.jsxs("span",{className:"rounded-full bg-[var(--bg-secondary)] px-3 py-1 text-sm text-[var(--text-secondary)]",children:[f.exhibits.length," ",i("search.items")]})]}),a.jsx("div",{className:"rounded-xl bg-[var(--bg-secondary)] p-6",children:a.jsx(b,{items:f.exhibits,variant:m,showTags:!0,showDescription:"list"===m,highlightText:e=>y(e,c),emptyMessage:i("exhibits.noExhibits"),filterType:"all"})})]},"exhibits-section"),f.stalls.length>0&&a.jsxs("section",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"h-8 w-1 rounded-full",style:{background:"linear-gradient(to bottom, var(--accent-orange), var(--accent-red))"}}),a.jsx(p,{size:24,style:{color:"var(--accent-orange)"}}),a.jsx("h3",{className:"text-xl font-semibold text-[var(--text-primary)]",children:i("exhibits.filters.stalls")}),a.jsx("div",{className:"h-px flex-1 bg-[var(--border-color)]"}),a.jsxs("span",{className:"rounded-full bg-[var(--bg-secondary)] px-3 py-1 text-sm text-[var(--text-secondary)]",children:[f.stalls.length," ",i("search.items")]})]}),a.jsx("div",{className:"rounded-xl bg-[var(--bg-secondary)] p-6",children:a.jsx(b,{items:f.stalls,variant:m,showTags:!0,showDescription:"list"===m,highlightText:e=>y(e,c),emptyMessage:i("exhibits.noStalls"),filterType:"all"})})]},"stalls-section")]})]}):a.jsx("div",{className:"py-12 text-center text-[var(--text-secondary)]",children:a.jsx("p",{children:i("search.searchPrompt")})})},w=l,k=c,T=i,S=n,C=e=>e.replace(/^\.?\/?images\//,"./images/"),$=()=>{const{performSearch:r,searchQuery:l,searchResults:c,setSearchQuery:n}=s(),{selectedTags:i}=t(),{t:o}=e(),m=d(),h=x.useMemo(()=>function(){const e=[...w.map(e=>e.imageUrl),...k.map(e=>e.imageUrl),...S.map(e=>e.imageUrl),...T.map(e=>e.imageUrl)].filter(Boolean).map(C);return f(e)||""}(),[]),u=l.trim().length>0||i.length>0||c.length>0;return x.useEffect(()=>{const e=new URLSearchParams(m.search).get("q");e&&e!==l&&(n(e),r(e))},[m.search,l,n,r]),a.jsxs("div",{className:"min-h-screen bg-[var(--bg-primary)]",children:[a.jsxs("section",{className:"relative overflow-hidden py-16",children:[a.jsx("img",{src:h,className:"pointer-events-none absolute inset-0 z-0 h-full w-full object-cover opacity-20",alt:"","aria-hidden":"true"}),a.jsx("div",{className:"absolute inset-0 opacity-10",style:{background:"var(--instagram-gradient)"}}),a.jsx("div",{className:"relative mx-auto max-w-7xl px-4 sm:px-6 lg:px-8",children:a.jsxs("div",{className:"text-center",children:[!u&&a.jsxs(a.Fragment,{children:[a.jsx("h1",{className:"mb-4 text-4xl font-bold text-[var(--text-primary)] md:text-5xl",children:o("search.title")}),a.jsx("p",{className:"mx-auto mb-8 max-w-2xl text-xl text-[var(--text-secondary)]",children:o("search.subtitle")})]}),a.jsx("div",{className:"mx-auto max-w-3xl",children:a.jsx(j,{variant:"large",autoFocus:!0,showSuggestions:!0})}),!u&&a.jsx("div",{className:"mx-auto mt-6 max-w-2xl",children:a.jsxs("div",{className:"rounded-xl border border-[var(--border-color)] bg-[var(--bg-secondary)] p-4",children:[a.jsxs("h3",{className:"mb-3 flex items-center justify-center gap-2 text-sm font-semibold text-[var(--text-primary)]",children:[a.jsx("span",{children:"💡"}),o("search.searchTips")]}),a.jsxs("div",{className:"space-y-2 text-sm text-[var(--text-secondary)]",children:[a.jsxs("div",{className:"flex items-start gap-2",children:[a.jsx("span",{className:"text-[var(--primary-color)]",children:"•"}),a.jsx("span",{children:o("search.searchInstructions.keyword")})]}),a.jsxs("div",{className:"flex items-start gap-2",children:[a.jsx("span",{className:"text-[var(--primary-color)]",children:"•"}),a.jsx("span",{children:o("search.searchInstructions.tags")})]}),a.jsxs("div",{className:"flex items-start gap-2",children:[a.jsx("span",{className:"text-[var(--primary-color)]",children:"•"}),a.jsx("span",{children:o("search.searchInstructions.location")})]})]})]})}),a.jsx("div",{className:"mx-auto mt-6 max-w-3xl",children:a.jsx(v,{compact:!1})})]})})]}),a.jsx("section",{className:"section bg-[var(--bg-primary)]",children:a.jsx("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8",children:a.jsx("div",{className:"space-y-8",children:a.jsx("div",{className:"rounded-xl bg-[var(--bg-primary)]",children:a.jsx(N,{})})})})})]})};export{$ as default};
