import{a as j,j as e,S as C,I as L,u as k,r as l,e as S,f as M,s as I}from"./index-DfMN3-aJ.js";import{S as T}from"./SelectedTags-A_WVycOs.js";import{T as H}from"./TagFilter-MmzAMeco.js";import{U as E,a as z}from"./UnifiedCard-B8ObpB9_.js";import{V as A}from"./VectorMap-Bm-pgkN7.js";import"./trash-2-B6zE72Am.js";import"./utensils-crossed-8b1A019x.js";const J=({getItemsForLocation:r,hoveredLocation:v,locations:p,onLocationHover:m,onLocationSelect:g,selectedLocation:f})=>{const{t:u}=j(),x=[...p].sort((a,t)=>{const n=r(a).length,o=r(t).length;return n!==o?o-n:a.localeCompare(t)});return e.jsxs("div",{className:"rounded-lg border border-white/20 bg-white/10 p-6",style:{backgroundColor:"var(--color-bg-secondary)"},children:[e.jsxs("h2",{className:"mb-6 flex items-center gap-2 text-xl font-semibold",style:{color:"var(--color-text-primary)"},children:[u("map.viewLocations")," (",x.length,")"]}),x.length===0?e.jsx("div",{className:"py-8 text-center",style:{color:"var(--color-text-secondary)"},children:u("map.noLocations")}):e.jsx("div",{className:"scrollbar-thin overflow-x-auto",children:e.jsx("div",{className:"flex gap-4 pb-4",style:{minWidth:"max-content"},children:x.map(a=>{const t=r(a),n=t[0];return n?e.jsx("div",{className:"w-80 flex-shrink-0",onMouseEnter:()=>m(a),onMouseLeave:()=>m(null),onClick:()=>g(a),children:e.jsxs("div",{className:"relative",children:[e.jsx(E,{item:n,variant:"default",showTags:!1,showDescription:!1,showAnimation:!0}),e.jsxs("div",{className:"absolute top-2 left-2 rounded-lg bg-black/80 px-3 py-1 text-white",children:[e.jsx("div",{className:"text-sm font-semibold",children:a}),e.jsxs("div",{className:"text-xs opacity-80",children:[t.length," ",(t.length===1,"項目")]})]}),e.jsx("div",{className:"absolute right-2 bottom-2 rounded-lg bg-black/80 px-2 py-1",children:e.jsx("div",{className:"text-xs text-white",children:(()=>{const o=t.filter(i=>i.type==="event").length,c=t.filter(i=>i.type==="exhibit").length,h=t.filter(i=>i.type==="stall").length;return e.jsxs("div",{className:"flex items-center gap-3",children:[o>0&&e.jsxs("div",{className:"flex items-center gap-1","aria-label":`${o} イベント`,children:[e.jsx(C,{size:14}),e.jsx("span",{className:"text-xs text-white",children:o})]}),c>0&&e.jsxs("div",{className:"flex items-center gap-1","aria-label":`${c} 展示`,children:[e.jsx(L,{size:14}),e.jsx("span",{className:"text-xs text-white",children:c})]}),h>0&&e.jsxs("div",{className:"flex items-center gap-1","aria-label":`${h} 出店`,children:[e.jsx(z,{size:14}),e.jsx("span",{className:"text-xs text-white",children:h})]})]})})()})})]})},a):null})})})]})},U=S,Z=M,$=I,B=r=>r.type==="event"||r.type==="exhibit"||r.type==="stall",F=()=>{const{t:r}=j(),{filterItemsByTags:v,selectedTags:p}=k(),m="70vh",[g,f]=l.useState(null),[u,x]=l.useState(null),a=l.useMemo(()=>U.filter(s=>s.showOnMap),[]),t=l.useMemo(()=>[...a,...Z,...$],[a]),n=l.useMemo(()=>[...new Set(t.map(s=>s.location))],[t]),o=l.useMemo(()=>p.length===0?t:v(t).filter(B),[t,p,v]),c=l.useMemo(()=>{const s={};for(const d of n){const b=o.filter(w=>w.location===d);b.length>0&&(s[d]=b)}return s},[n,o]),h=l.useCallback(s=>{f(s)},[]),i=l.useCallback(s=>{x(d=>s===d?null:s)},[]),y=l.useCallback(s=>o.filter(d=>d.location===s),[o]),N=l.useMemo(()=>Object.keys(c),[c]);return e.jsx("div",{className:"min-h-screen",children:e.jsxs("section",{className:"section py-8",style:{backgroundColor:"var(--color-bg-primary)"},children:[e.jsxs("div",{className:"mx-auto max-w-7xl",children:[e.jsx("div",{className:"mb-8",children:e.jsx("h1",{className:"text-3xl font-bold",style:{color:"var(--color-text-primary)"},children:r("map.title")})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx(H,{compact:!0}),e.jsx(T,{})]}),e.jsx("div",{className:"w-full",children:e.jsxs("div",{className:"relative overflow-hidden rounded-lg",style:{backgroundColor:"var(--color-bg-secondary)"},children:[e.jsx("div",{className:"border-b p-4",style:{borderColor:"var(--color-border-primary)"},children:e.jsx("h2",{className:"flex items-center gap-2 text-xl font-semibold",style:{color:"var(--color-text-primary)"},children:"会場マップ"})}),e.jsx("div",{className:"relative",children:e.jsx("div",{className:"map-container relative m-4",style:{backgroundColor:"var(--color-bg-secondary)",borderColor:"var(--color-border-primary)",minHeight:m},children:e.jsx(A,{mode:"display",points:o.filter(s=>s.coordinates).map(s=>({contentItem:s,coordinates:s.coordinates,id:s.id,isHovered:!1,isSelected:!1,onClick:()=>{},onHover:()=>{},title:s.title,type:s.type})),height:m,className:"rounded-lg",maxZoom:8,minZoom:.3,showControls:!0,initialZoom:2})})})]})})]})]}),e.jsx("div",{className:"mt-6",children:e.jsx(J,{locations:N,getItemsForLocation:y,onLocationSelect:i,onLocationHover:h,hoveredLocation:g,selectedLocation:u})})]})})};export{F as default};
