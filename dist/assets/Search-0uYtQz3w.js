import{a as k,l as R,c as J,r as d,j as e,m as $,u as z,b as K,S as q,I as G,n as H,e as V,f as W,s as O,k as X}from"./index-DfMN3-aJ.js";import{T as Y}from"./TagFilter-MmzAMeco.js";import{C as Z,a as w}from"./CardListToggle-m7dyg1Ld.js";import{U as _}from"./utensils-crossed-8b1A019x.js";import{p as ee}from"./random-DoZnV0pN.js";import"./UnifiedCard-B8ObpB9_.js";const se=({autoFocus:c=!1,className:t="",placeholder:g,showSuggestions:s=!1,variant:i="default"})=>{const{t:l}=k(),{performSearch:x,recentSearches:y,searchQuery:r,setSearchQuery:N}=R(),u=J(),[b,o]=d.useState(r),[p,m]=d.useState(!1),[h,v]=d.useState(-1),f=d.useRef(null),F=d.useRef(null),T=d.useRef(null);d.useEffect(()=>{c&&f.current&&f.current.focus()},[c]),d.useEffect(()=>{o(r)},[r]);const L=a=>{const n=a.target.value;o(n),v(-1),s&&n.trim()?m(!0):m(!1)},C=a=>{a.preventDefault(),b.trim()&&(x(b.trim()),u(`/search?q=${encodeURIComponent(b.trim())}`),m(!1),setTimeout(()=>{f.current&&f.current.focus()},0))},I=a=>{o(a),N(a),x(a),u(`/search?q=${encodeURIComponent(a)}`),m(!1),setTimeout(()=>{f.current&&f.current.focus()},0)},U=a=>{if(a.key==="Escape"&&!p){D();return}if(!p)return;const n=y;switch(a.key){case"ArrowDown":{a.preventDefault(),v(j=>j<n.length-1?j+1:j);break}case"ArrowUp":{a.preventDefault(),v(j=>j>0?j-1:j);break}case"Enter":{a.preventDefault(),h>=0&&n[h]?I(n[h]):C(a);break}case"Escape":{m(!1),v(-1);break}}},Q=()=>{s&&y.length>0&&m(!0)},M=a=>{setTimeout(()=>{var n;!((n=T.current)!=null&&n.contains(a.relatedTarget))&&a.relatedTarget!==f.current&&(m(!1),v(-1))},150)},D=()=>{o(""),N(""),m(!1),window.location.hash.includes("/search")&&u("/search",{replace:!0}),f.current&&f.current.focus()},B=()=>{const n=`group relative flex w-full items-center gap-3 ${p?"rounded-t-3xl":"rounded-full"} border border-[var(--border-color)] bg-[var(--bg-secondary)] px-4 shadow-sm transition-all duration-200`;switch(i){case"large":return`${n} h-12`;case"inline":return`${n} h-9`;default:return`${n} h-10`}},P=()=>{switch(i){case"large":return"text-base";case"inline":return"text-xs";default:return"text-sm"}},A=()=>{switch(i){case"large":return 24;case"inline":return 16;default:return 20}},E=s?y:[];return e.jsxs("div",{className:`relative w-full ${t}`,children:[e.jsx("div",{ref:F,className:B(),children:e.jsxs("form",{onSubmit:C,className:"flex w-full items-center gap-2",role:"search","aria-label":l("actions.search"),children:[e.jsx($,{size:A(),className:"shrink-0 text-[var(--text-secondary)]"}),e.jsx("input",{ref:f,type:"text",value:b,onChange:L,onKeyDown:U,onFocus:Q,onBlur:M,placeholder:g||l("search.placeholder"),className:`peer w-full border-0 bg-transparent py-0 leading-tight ${P()} text-sm placeholder-[var(--text-secondary)] outline-none`,autoComplete:"off",role:"searchbox","aria-label":l("search.placeholder"),"aria-expanded":p,"aria-haspopup":"listbox"}),b.trim()&&e.jsx("button",{type:"button",onClick:D,className:"rounded-full p-1.5 text-[var(--text-secondary)] transition-all duration-200 hover:bg-[var(--bg-primary)] hover:text-[var(--text-primary)]","aria-label":l("actions.clear"),title:l("actions.clear"),children:e.jsx("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),p&&E.length>0&&e.jsx("div",{ref:T,className:"absolute top-full right-0 left-0 z-50 -mt-px max-h-64 overflow-y-auto rounded-b-3xl border border-t-0 border-[var(--border-color)] bg-[var(--bg-secondary)] shadow-sm",children:e.jsx("div",{className:"py-2",role:"listbox","aria-label":l("search.suggestions"),children:E.map((a,n)=>e.jsxs("button",{onClick:()=>I(a),className:`flex w-full items-center gap-3 px-4 py-2.5 text-left transition-all duration-200 ${h===n?"bg-[var(--bg-tertiary)] text-[var(--primary-color)]":"text-[var(--text-primary)] hover:bg-[var(--bg-primary)]"}`,role:"option","aria-selected":h===n,children:[e.jsx($,{size:16,className:"text-[var(--text-secondary)]"}),e.jsx("span",{className:"flex-1",children:a}),e.jsx("span",{className:"text-xs text-[var(--text-secondary)]",children:l("search.recentSearches")})]},n))})})]})};function S(c,t){if(!t.trim()||!c)return e.jsx(e.Fragment,{children:c});try{const g=c.split(new RegExp(`(${t})`,"gi"));return e.jsx(e.Fragment,{children:g.map((s,i)=>s.toLowerCase()===t.toLowerCase()?e.jsx("mark",{className:"rounded bg-gradient-to-r from-[var(--accent-yellow)] to-[var(--accent-orange)] px-1 text-[var(--text-primary)]",children:s},i):s)})}catch(g){return console.error("Error highlighting text:",g),e.jsx(e.Fragment,{children:c})}}const te=()=>{const{isSearching:c,searchQuery:t,searchResults:g}=R(),{t:s}=k(),{selectedTags:i}=z(),{filterByTags:l}=K(),[x,y]=d.useState("default"),[r,N]=d.useState({events:[],exhibits:[],stalls:[]}),u=d.useCallback(o=>i.length===0?o:o.filter(p=>i.every(m=>{var h;return(h=p.tags)==null?void 0:h.includes(m)})),[i]);d.useEffect(()=>{const o=t.trim();let p=g;o||(p=i.length>0?l(i):[]);const m=i.length>0?u(p):p,h={events:[],exhibits:[],stalls:[]};for(const v of m)switch(v.type){case"event":{h.events.push(v);break}case"exhibit":{h.exhibits.push(v);break}case"stall":{h.stalls.push(v);break}}N(h)},[g,u,i,t,l]);const b=r.events.length+r.exhibits.length+r.stalls.length;return c?e.jsxs("div",{className:"py-12 text-center",children:[e.jsx("div",{className:"mx-auto mb-4 h-8 w-8 animate-spin rounded-full border-4 border-[var(--primary-color)] border-t-transparent"}),e.jsx("span",{className:"text-[var(--text-secondary)]",children:s("search.searching")})]}):!t&&i.length===0?e.jsx("div",{className:"py-12 text-center text-[var(--text-secondary)]",children:e.jsx("p",{children:s("search.searchPrompt")})}):b===0?e.jsxs("div",{className:"py-12 text-center",children:[e.jsx("h2",{className:"mb-2 text-xl font-semibold text-[var(--text-primary)]",children:s("search.noResults")}),e.jsx("p",{className:"text-[var(--text-secondary)]",children:s("search.tryDifferentKeywords")})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col items-start justify-between gap-4 rounded-xl border border-[var(--border-color)] bg-[var(--bg-secondary)] p-6 sm:flex-row sm:items-center",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-[var(--text-primary)]",children:s("search.results")}),b>0&&e.jsxs("span",{className:"rounded-full bg-[var(--primary-color)] px-3 py-1 text-sm font-medium text-white",children:[b," ",s("search.items")]})]}),e.jsx(Z,{viewMode:x,setViewMode:y})]}),e.jsxs("div",{className:"space-y-8",children:[r.events.length>0&&e.jsxs("section",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-8 w-1 rounded-full",style:{background:"linear-gradient(to bottom, var(--accent-purple), var(--accent-pink))"}}),e.jsx(q,{size:24,style:{color:"var(--accent-purple)"}}),e.jsx("h3",{className:"text-xl font-semibold text-[var(--text-primary)]",children:s("navigation.events")}),e.jsx("div",{className:"h-px flex-1 bg-[var(--border-color)]"}),e.jsxs("span",{className:"rounded-full bg-[var(--bg-secondary)] px-3 py-1 text-sm text-[var(--text-secondary)]",children:[r.events.length," ",s("search.items")]})]}),e.jsx("div",{className:"rounded-xl bg-[var(--bg-secondary)] p-6",children:e.jsx(w,{items:r.events,variant:x,showTags:!0,showDescription:x==="list",highlightText:o=>S(o,t),emptyMessage:s("events.noEventsFound"),filterType:"all"})})]},"events-section"),r.exhibits.length>0&&e.jsxs("section",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-8 w-1 rounded-full",style:{background:"linear-gradient(to bottom, var(--accent-blue), var(--accent-teal))"}}),e.jsx(G,{size:24,style:{color:"var(--accent-blue)"}}),e.jsx("h3",{className:"text-xl font-semibold text-[var(--text-primary)]",children:s("exhibits.filters.exhibits")}),e.jsx("div",{className:"h-px flex-1 bg-[var(--border-color)]"}),e.jsxs("span",{className:"rounded-full bg-[var(--bg-secondary)] px-3 py-1 text-sm text-[var(--text-secondary)]",children:[r.exhibits.length," ",s("search.items")]})]}),e.jsx("div",{className:"rounded-xl bg-[var(--bg-secondary)] p-6",children:e.jsx(w,{items:r.exhibits,variant:x,showTags:!0,showDescription:x==="list",highlightText:o=>S(o,t),emptyMessage:s("exhibits.noExhibits"),filterType:"all"})})]},"exhibits-section"),r.stalls.length>0&&e.jsxs("section",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-8 w-1 rounded-full",style:{background:"linear-gradient(to bottom, var(--accent-orange), var(--accent-red))"}}),e.jsx(_,{size:24,style:{color:"var(--accent-orange)"}}),e.jsx("h3",{className:"text-xl font-semibold text-[var(--text-primary)]",children:s("exhibits.filters.stalls")}),e.jsx("div",{className:"h-px flex-1 bg-[var(--border-color)]"}),e.jsxs("span",{className:"rounded-full bg-[var(--bg-secondary)] px-3 py-1 text-sm text-[var(--text-secondary)]",children:[r.stalls.length," ",s("search.items")]})]}),e.jsx("div",{className:"rounded-xl bg-[var(--bg-secondary)] p-6",children:e.jsx(w,{items:r.stalls,variant:x,showTags:!0,showDescription:x==="list",highlightText:o=>S(o,t),emptyMessage:s("exhibits.noStalls"),filterType:"all"})})]},"stalls-section")]})]})},ae=V,re=W,le=X,ne=O,ce=c=>c.replace(/^\.?\/?images\//,"./images/");function ie(){const c=[...ae.map(t=>t.imageUrl),...re.map(t=>t.imageUrl),...ne.map(t=>t.imageUrl),...le.map(t=>t.imageUrl)].filter(Boolean).map(ce);return ee(c)||""}const pe=()=>{const{performSearch:c,searchQuery:t,searchResults:g,setSearchQuery:s}=R(),{selectedTags:i}=z(),{t:l}=k(),x=H(),y=d.useMemo(()=>ie(),[]),r=t.trim().length>0||i.length>0||g.length>0;return d.useEffect(()=>{const u=new URLSearchParams(x.search).get("q");u&&u!==t&&(s(u),c(u))},[x.search,t,s,c]),e.jsxs("div",{className:"min-h-screen bg-[var(--bg-primary)]",children:[e.jsxs("section",{className:"relative overflow-hidden py-16",children:[e.jsx("img",{src:y,className:"pointer-events-none absolute inset-0 z-0 h-full w-full object-cover opacity-20",alt:"","aria-hidden":"true"}),e.jsx("div",{className:"absolute inset-0 opacity-10",style:{background:"var(--instagram-gradient)"}}),e.jsx("div",{className:"relative mx-auto max-w-7xl px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"text-center",children:[!r&&e.jsxs(e.Fragment,{children:[e.jsx("h1",{className:"mb-4 text-4xl font-bold text-[var(--text-primary)] md:text-5xl",children:l("search.title")}),e.jsx("p",{className:"mx-auto mb-8 max-w-2xl text-xl text-[var(--text-secondary)]",children:l("search.subtitle")})]}),e.jsx("div",{className:"mx-auto max-w-3xl",children:e.jsx(se,{variant:"large",autoFocus:!0,showSuggestions:!0})}),!r&&e.jsx("div",{className:"mx-auto mt-6 max-w-2xl",children:e.jsxs("div",{className:"rounded-xl border border-[var(--border-color)] bg-[var(--bg-secondary)] p-4",children:[e.jsxs("h3",{className:"mb-3 flex items-center justify-center gap-2 text-sm font-semibold text-[var(--text-primary)]",children:[e.jsx("span",{children:"💡"}),l("search.searchTips")]}),e.jsxs("div",{className:"space-y-2 text-sm text-[var(--text-secondary)]",children:[e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-[var(--primary-color)]",children:"•"}),e.jsx("span",{children:l("search.searchInstructions.keyword")})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-[var(--primary-color)]",children:"•"}),e.jsx("span",{children:l("search.searchInstructions.tags")})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-[var(--primary-color)]",children:"•"}),e.jsx("span",{children:l("search.searchInstructions.location")})]})]})]})}),e.jsx("div",{className:"mx-auto mt-6 max-w-3xl",children:e.jsx(Y,{compact:!1})})]})})]}),e.jsx("section",{className:"section bg-[var(--bg-primary)]",children:e.jsx("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8",children:e.jsx("div",{className:"space-y-8",children:e.jsx("div",{className:"rounded-xl bg-[var(--bg-primary)]",children:e.jsx(te,{})})})})})]})};export{pe as default};
