import{a as E,k as D,h as K,r as i,l as T,E as R,D as C,j as e,S as M,u as L,m as q}from"./index-DiK8qNwB.js";import{C as W,a as k}from"./CardListToggle-DwKlmiDF.js";import{T as G}from"./TagFilter-B8_RKDbe.js";import"./UnifiedCard-CHoqHSgW.js";const V=({variant:h="default",placeholder:v,autoFocus:b=!1,showSuggestions:s=!1,className:m=""})=>{const{t:n}=E(),{searchQuery:u,setSearchQuery:t,performSearch:p,recentSearches:N}=D(),y=K(),[x,l]=i.useState(u),[c,a]=i.useState(!1),[d,g]=i.useState(-1),j=i.useRef(null),w=i.useRef(null),S=i.useRef(null),F=i.useRef(null);i.useEffect(()=>{b&&j.current&&j.current.focus()},[b]),i.useEffect(()=>{l(u)},[u]),i.useEffect(()=>{w.current&&(c?T.to(w.current,{boxShadow:"0 4px 12px rgba(0, 0, 0, 0.1)",borderColor:"var(--primary-color)",duration:C.FAST,ease:R.SMOOTH}):T.to(w.current,{boxShadow:"0 2px 8px rgba(0, 0, 0, 0.05)",borderColor:"var(--border-color)",duration:C.FAST,ease:R.SMOOTH}))},[c]),i.useEffect(()=>{S.current&&(c?T.fromTo(S.current,{y:-10,autoAlpha:0},{y:0,autoAlpha:1,duration:C.FAST,ease:R.SMOOTH}):T.to(S.current,{y:-10,autoAlpha:0,duration:C.FAST,ease:R.SMOOTH}))},[c]);const O=r=>{const o=r.target.value;l(o),t(o),g(-1),s&&o.trim()?a(!0):a(!1)},I=r=>{r.preventDefault(),x.trim()&&(p(x.trim()),y(`/search?q=${encodeURIComponent(x.trim())}`),a(!1))},$=r=>{l(r),t(r),p(r),y(`/search?q=${encodeURIComponent(r)}`),a(!1)},Q=r=>{if(!c)return;const o=N;switch(r.key){case"ArrowDown":r.preventDefault(),g(f=>f<o.length-1?f+1:f);break;case"ArrowUp":r.preventDefault(),g(f=>f>0?f-1:f);break;case"Enter":r.preventDefault(),d>=0&&o[d]?$(o[d]):I(r);break;case"Escape":a(!1),g(-1);break}},z=()=>{s&&x.trim()&&a(!0)},B=r=>{setTimeout(()=>{var o;!((o=F.current)!=null&&o.contains(r.relatedTarget))&&r.relatedTarget!==j.current&&(a(!1),g(-1))},150)},H=()=>{l(""),t(""),a(!1),j.current&&j.current.focus()},P=()=>{const r=`
      w-full pl-12 border transition-all duration-200 focus:outline-none focus:ring-2
      bg-[var(--bg-primary)] border-[var(--border-color)] text-[var(--text-primary)]
      placeholder-[var(--text-secondary)] focus:border-[var(--primary-color)] 
      focus:ring-[var(--primary-color)]/20
    `,o=x.trim()?"pr-32":"pr-20";switch(h){case"large":return`${r} ${o} py-4 text-lg rounded-full focus:ring-4`;case"inline":return`${r} ${o} py-2 text-sm rounded-full`;default:return`${r} ${o} py-3 text-base rounded-full`}},U=()=>{switch(h){case"large":return 24;case"inline":return 16;default:return 20}},A=s?N:[];return e.jsxs("div",{className:`relative w-full ${m}`,children:[e.jsx("form",{ref:w,onSubmit:I,className:"relative w-full",children:e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute left-4 top-1/2 transform -translate-y-1/2 z-10",children:e.jsx(M,{size:U(),className:"text-[var(--text-secondary)]"})}),e.jsx("input",{ref:j,type:"text",value:x,onChange:O,onKeyDown:Q,onFocus:z,onBlur:B,placeholder:v||n("search.placeholder"),className:P(),autoComplete:"off",role:"searchbox","aria-label":n("search.placeholder"),"aria-expanded":c,"aria-haspopup":"listbox"}),x.trim()&&e.jsx("button",{type:"button",onClick:H,className:"absolute right-20 top-1/2 transform -translate-y-1/2 p-1 rounded-full transition-all duration-200 hover:bg-[var(--bg-secondary)] text-[var(--text-secondary)] hover:text-[var(--text-primary)]","aria-label":n("actions.clear"),children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),e.jsx("button",{type:"submit",className:"absolute right-2 top-1/2 transform -translate-y-1/2 px-4 py-2 bg-[var(--primary-color)] text-white rounded-full font-medium transition-all duration-200 hover:shadow-lg hover:scale-105 active:scale-95 focus:outline-none focus:ring-2 focus:ring-[var(--primary-color)]/20 hover:bg-[var(--primary-color)]/90","aria-label":n("actions.search"),children:n("actions.search")})]})}),c&&A.length>0&&e.jsx("div",{ref:F,className:"absolute top-full left-0 right-0 mt-2 bg-[var(--bg-primary)] border border-[var(--border-color)] rounded-lg shadow-lg z-50 max-h-64 overflow-y-auto",children:e.jsx("div",{ref:S,className:"py-2",role:"listbox","aria-label":n("search.suggestions"),children:A.map((r,o)=>e.jsxs("button",{onClick:()=>$(r),className:`w-full text-left px-4 py-3 flex items-center gap-3 transition-all duration-200 ${d===o?"bg-[var(--bg-tertiary)] text-[var(--primary-color)]":"text-[var(--text-primary)] hover:bg-[var(--bg-secondary)]"}`,role:"option","aria-selected":d===o,children:[e.jsx(M,{size:16,className:"text-[var(--text-secondary)]"}),e.jsx("span",{className:"flex-1",children:r}),e.jsx("span",{className:"text-xs text-[var(--text-secondary)]",children:n("search.recentSearches")})]},o))})})]})},J=()=>{const{searchQuery:h,searchResults:v,isSearching:b}=D(),{t:s}=E(),{selectedTags:m}=L(),[n,u]=i.useState("default"),[t,p]=i.useState({events:[],exhibits:[],stalls:[]}),N=i.useCallback(l=>m.length===0?l:l.filter(c=>m.every(a=>{var d;return(d=c.tags)==null?void 0:d.includes(a)})),[m]);i.useEffect(()=>{const l=N(v),c={events:[],exhibits:[],stalls:[]};l.forEach(a=>{a.type==="event"?c.events.push(a):a.type==="exhibit"?c.exhibits.push(a):a.type==="stall"&&c.stalls.push(a)}),p(c)},[v,N]);const y=(l,c)=>{if(!c.trim()||!l)return e.jsx(e.Fragment,{children:l});try{const a=l.split(new RegExp(`(${c})`,"gi"));return e.jsx(e.Fragment,{children:a.map((d,g)=>d.toLowerCase()===c.toLowerCase()?e.jsx("mark",{className:"bg-gradient-to-r from-[var(--accent-yellow)] to-[var(--accent-orange)] text-[var(--text-primary)] px-1 rounded",children:d},g):d)})}catch(a){return console.error("Error highlighting text:",a),e.jsx(e.Fragment,{children:l})}},x=t.events.length+t.exhibits.length+t.stalls.length;return b?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-[var(--primary-color)] border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("span",{className:"text-[var(--text-secondary)]",children:s("search.searching")})]}):!h&&m.length===0?e.jsx("div",{className:"text-center py-12 text-[var(--text-secondary)]",children:e.jsx("p",{children:s("search.searchPrompt")})}):x===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("h2",{className:"text-xl font-semibold text-[var(--text-primary)] mb-2",children:s("search.noResults")}),e.jsx("p",{className:"text-[var(--text-secondary)]",children:s("search.tryDifferentKeywords")})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 p-6 bg-[var(--bg-secondary)] rounded-xl border border-[var(--border-color)]",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-[var(--text-primary)]",children:s("search.results")}),x>0&&e.jsxs("span",{className:"px-3 py-1 bg-[var(--primary-color)] text-white rounded-full text-sm font-medium",children:[x," ",s("search.items")]})]}),e.jsx(W,{viewMode:n,setViewMode:u})]}),e.jsxs("div",{className:"space-y-8",children:[t.events.length>0&&e.jsxs("section",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-1 h-8 bg-gradient-to-b from-[var(--accent-purple)] to-[var(--accent-pink)] rounded-full"}),e.jsxs("h3",{className:"text-xl font-semibold text-[var(--text-primary)]",children:["🎭 ",s("navigation.events")]}),e.jsx("div",{className:"flex-1 h-px bg-[var(--border-color)]"}),e.jsxs("span",{className:"text-sm text-[var(--text-secondary)] bg-[var(--bg-secondary)] px-3 py-1 rounded-full",children:[t.events.length," ",s("search.items")]})]}),e.jsx("div",{className:"bg-[var(--bg-secondary)] rounded-xl p-6",children:e.jsx(k,{items:t.events,variant:n,showTags:!0,showDescription:n==="list",highlightText:l=>y(l,h),emptyMessage:s("events.noEventsFound"),filterType:"all"})})]}),t.exhibits.length>0&&e.jsxs("section",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-1 h-8 bg-gradient-to-b from-[var(--accent-blue)] to-[var(--accent-teal)] rounded-full"}),e.jsxs("h3",{className:"text-xl font-semibold text-[var(--text-primary)]",children:["🎨 ",s("exhibits.filters.exhibits")]}),e.jsx("div",{className:"flex-1 h-px bg-[var(--border-color)]"}),e.jsxs("span",{className:"text-sm text-[var(--text-secondary)] bg-[var(--bg-secondary)] px-3 py-1 rounded-full",children:[t.exhibits.length," ",s("search.items")]})]}),e.jsx("div",{className:"bg-[var(--bg-secondary)] rounded-xl p-6",children:e.jsx(k,{items:t.exhibits,variant:n,showTags:!0,showDescription:n==="list",highlightText:l=>y(l,h),emptyMessage:s("exhibits.noExhibits"),filterType:"all"})})]}),t.stalls.length>0&&e.jsxs("section",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-1 h-8 bg-gradient-to-b from-[var(--accent-orange)] to-[var(--accent-red)] rounded-full"}),e.jsxs("h3",{className:"text-xl font-semibold text-[var(--text-primary)]",children:["🍜 ",s("exhibits.filters.stalls")]}),e.jsx("div",{className:"flex-1 h-px bg-[var(--border-color)]"}),e.jsxs("span",{className:"text-sm text-[var(--text-secondary)] bg-[var(--bg-secondary)] px-3 py-1 rounded-full",children:[t.stalls.length," ",s("search.items")]})]}),e.jsx("div",{className:"bg-[var(--bg-secondary)] rounded-xl p-6",children:e.jsx(k,{items:t.stalls,variant:n,showTags:!0,showDescription:n==="list",highlightText:l=>y(l,h),emptyMessage:s("exhibits.noStalls"),filterType:"all"})})]})]})]})},ee=()=>{const{searchQuery:h,setSearchQuery:v,performSearch:b}=D(),{t:s}=E(),{selectTag:m}=L(),n=q();return i.useEffect(()=>{const u=new URLSearchParams(n.search),t=u.get("q"),p=u.get("tag");t&&t!==h&&(v(t),b(t)),p&&m(p)},[n.search]),e.jsxs("div",{className:"min-h-screen bg-[var(--bg-primary)]",children:[e.jsxs("section",{className:"relative overflow-hidden py-16",children:[e.jsx("div",{className:"absolute inset-0 opacity-10",style:{background:"var(--instagram-gradient)"}}),e.jsx("div",{className:"relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-4xl md:text-5xl font-bold text-[var(--text-primary)] mb-4",children:s("search.title")}),e.jsx("p",{className:"text-xl text-[var(--text-secondary)] max-w-2xl mx-auto mb-8",children:s("search.subtitle")}),e.jsx("div",{className:"max-w-3xl mx-auto",children:e.jsx(V,{variant:"large",autoFocus:!0,showSuggestions:!0})}),e.jsx("div",{className:"max-w-2xl mx-auto mt-6",children:e.jsxs("div",{className:"bg-[var(--bg-secondary)] border border-[var(--border-color)] rounded-xl p-4",children:[e.jsxs("h3",{className:"text-sm font-semibold mb-3 text-[var(--text-primary)] flex items-center justify-center gap-2",children:[e.jsx("span",{children:"💡"}),s("search.searchTips")]}),e.jsxs("div",{className:"space-y-2 text-sm text-[var(--text-secondary)]",children:[e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-[var(--primary-color)]",children:"•"}),e.jsx("span",{children:s("search.searchInstructions.keyword")})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-[var(--primary-color)]",children:"•"}),e.jsx("span",{children:s("search.searchInstructions.tags")})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-[var(--primary-color)]",children:"•"}),e.jsx("span",{children:s("search.searchInstructions.location")})]})]})]})})]})})]}),e.jsx("section",{className:"section bg-[var(--bg-primary)]",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"space-y-8",children:[e.jsx(G,{onFilter:()=>{},compact:!1}),e.jsx("div",{className:"bg-[var(--bg-primary)] rounded-xl",children:e.jsx(J,{})})]})})})]})};export{ee as default};
