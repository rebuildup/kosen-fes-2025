import{a as E,k as D,h as P,r as o,l as T,E as R,D as C,j as e,m as M,u as K,b as q,n as W}from"./index-7WYLCOyL.js";import{C as G,a as k}from"./CardListToggle-CQToBFO-.js";import{T as V}from"./TagFilter-B-Quy9B5.js";import"./UnifiedCard-BIaf6bta.js";const J=({variant:m="default",placeholder:v,autoFocus:b=!1,showSuggestions:s=!1,className:x=""})=>{const{t:u}=E(),{searchQuery:c,setSearchQuery:y,performSearch:i,recentSearches:N}=D(),j=P(),[p,f]=o.useState(c),[a,t]=o.useState(!1),[h,n]=o.useState(-1),d=o.useRef(null),w=o.useRef(null),S=o.useRef(null),F=o.useRef(null);o.useEffect(()=>{b&&d.current&&d.current.focus()},[b]),o.useEffect(()=>{f(c)},[c]),o.useEffect(()=>{w.current&&(a?T.to(w.current,{boxShadow:"0 4px 12px rgba(0, 0, 0, 0.1)",borderColor:"var(--primary-color)",duration:C.FAST,ease:R.SMOOTH}):T.to(w.current,{boxShadow:"0 2px 8px rgba(0, 0, 0, 0.05)",borderColor:"var(--border-color)",duration:C.FAST,ease:R.SMOOTH}))},[a]),o.useEffect(()=>{S.current&&(a?T.fromTo(S.current,{y:-10,autoAlpha:0},{y:0,autoAlpha:1,duration:C.FAST,ease:R.SMOOTH}):T.to(S.current,{y:-10,autoAlpha:0,duration:C.FAST,ease:R.SMOOTH}))},[a]);const L=r=>{const l=r.target.value;f(l),y(l),n(-1),s&&l.trim()?t(!0):t(!1)},I=r=>{r.preventDefault(),p.trim()&&(i(p.trim()),j(`/search?q=${encodeURIComponent(p.trim())}`),t(!1))},$=r=>{f(r),y(r),i(r),j(`/search?q=${encodeURIComponent(r)}`),t(!1)},O=r=>{if(!a)return;const l=N;switch(r.key){case"ArrowDown":r.preventDefault(),n(g=>g<l.length-1?g+1:g);break;case"ArrowUp":r.preventDefault(),n(g=>g>0?g-1:g);break;case"Enter":r.preventDefault(),h>=0&&l[h]?$(l[h]):I(r);break;case"Escape":t(!1),n(-1);break}},Q=()=>{s&&p.trim()&&t(!0)},z=r=>{setTimeout(()=>{var l;!((l=F.current)!=null&&l.contains(r.relatedTarget))&&r.relatedTarget!==d.current&&(t(!1),n(-1))},150)},B=()=>{f(""),y(""),t(!1),d.current&&d.current.focus()},H=()=>{const r=`
      w-full pl-12 border transition-all duration-200 focus:outline-none focus:ring-2
      bg-[var(--bg-primary)] border-[var(--border-color)] text-[var(--text-primary)]
      placeholder-[var(--text-secondary)] focus:border-[var(--primary-color)] 
      focus:ring-[var(--primary-color)]/20
    `,l=p.trim()?"pr-32":"pr-20";switch(m){case"large":return`${r} ${l} py-4 text-lg rounded-full focus:ring-4`;case"inline":return`${r} ${l} py-2 text-sm rounded-full`;default:return`${r} ${l} py-3 text-base rounded-full`}},U=()=>{switch(m){case"large":return 24;case"inline":return 16;default:return 20}},A=s?N:[];return e.jsxs("div",{className:`relative w-full ${x}`,children:[e.jsx("form",{ref:w,onSubmit:I,className:"relative w-full",children:e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute left-4 top-1/2 transform -translate-y-1/2 z-10",children:e.jsx(M,{size:U(),className:"text-[var(--text-secondary)]"})}),e.jsx("input",{ref:d,type:"text",value:p,onChange:L,onKeyDown:O,onFocus:Q,onBlur:z,placeholder:v||u("search.placeholder"),className:H(),autoComplete:"off",role:"searchbox","aria-label":u("search.placeholder"),"aria-expanded":a,"aria-haspopup":"listbox"}),p.trim()&&e.jsx("button",{type:"button",onClick:B,className:"absolute right-20 top-1/2 transform -translate-y-1/2 p-1 rounded-full transition-all duration-200 hover:bg-[var(--bg-secondary)] text-[var(--text-secondary)] hover:text-[var(--text-primary)]","aria-label":u("actions.clear"),children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),e.jsx("button",{type:"submit",className:"absolute right-2 top-1/2 transform -translate-y-1/2 px-4 py-2 bg-[var(--primary-color)] text-white rounded-full font-medium transition-all duration-200 hover:shadow-lg hover:scale-105 active:scale-95 focus:outline-none focus:ring-2 focus:ring-[var(--primary-color)]/20 hover:bg-[var(--primary-color)]/90","aria-label":u("actions.search"),children:u("actions.search")})]})}),a&&A.length>0&&e.jsx("div",{ref:F,className:"absolute top-full left-0 right-0 mt-2 bg-[var(--bg-primary)] border border-[var(--border-color)] rounded-lg shadow-lg z-50 max-h-64 overflow-y-auto",children:e.jsx("div",{ref:S,className:"py-2",role:"listbox","aria-label":u("search.suggestions"),children:A.map((r,l)=>e.jsxs("button",{onClick:()=>$(r),className:`w-full text-left px-4 py-3 flex items-center gap-3 transition-all duration-200 ${h===l?"bg-[var(--bg-tertiary)] text-[var(--primary-color)]":"text-[var(--text-primary)] hover:bg-[var(--bg-secondary)]"}`,role:"option","aria-selected":h===l,children:[e.jsx(M,{size:16,className:"text-[var(--text-secondary)]"}),e.jsx("span",{className:"flex-1",children:r}),e.jsx("span",{className:"text-xs text-[var(--text-secondary)]",children:u("search.recentSearches")})]},l))})})]})},X=()=>{const{searchQuery:m,searchResults:v,isSearching:b}=D(),{t:s}=E(),{selectedTags:x}=K(),{filterByTags:u}=q(),[c,y]=o.useState("default"),[i,N]=o.useState({events:[],exhibits:[],stalls:[]}),j=o.useCallback(a=>x.length===0?a:a.filter(t=>x.every(h=>{var n;return(n=t.tags)==null?void 0:n.includes(h)})),[x]);o.useEffect(()=>{const a=m.trim();let t=v;a||(t=x.length>0?u(x):[]);const h=x.length>0?j(t):t,n={events:[],exhibits:[],stalls:[]};h.forEach(d=>{d.type==="event"?n.events.push(d):d.type==="exhibit"?n.exhibits.push(d):d.type==="stall"&&n.stalls.push(d)}),N(n)},[v,j,x,m,u]);const p=(a,t)=>{if(!t.trim()||!a)return e.jsx(e.Fragment,{children:a});try{const h=a.split(new RegExp(`(${t})`,"gi"));return e.jsx(e.Fragment,{children:h.map((n,d)=>n.toLowerCase()===t.toLowerCase()?e.jsx("mark",{className:"bg-gradient-to-r from-[var(--accent-yellow)] to-[var(--accent-orange)] text-[var(--text-primary)] px-1 rounded",children:n},d):n)})}catch(h){return console.error("Error highlighting text:",h),e.jsx(e.Fragment,{children:a})}},f=i.events.length+i.exhibits.length+i.stalls.length;return b?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-[var(--primary-color)] border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("span",{className:"text-[var(--text-secondary)]",children:s("search.searching")})]}):!m&&x.length===0?e.jsx("div",{className:"text-center py-12 text-[var(--text-secondary)]",children:e.jsx("p",{children:s("search.searchPrompt")})}):f===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("h2",{className:"text-xl font-semibold text-[var(--text-primary)] mb-2",children:s("search.noResults")}),e.jsx("p",{className:"text-[var(--text-secondary)]",children:s("search.tryDifferentKeywords")})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 p-6 bg-[var(--bg-secondary)] rounded-xl border border-[var(--border-color)]",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-[var(--text-primary)]",children:s("search.results")}),f>0&&e.jsxs("span",{className:"px-3 py-1 bg-[var(--primary-color)] text-white rounded-full text-sm font-medium",children:[f," ",s("search.items")]})]}),e.jsx(G,{viewMode:c,setViewMode:y})]}),e.jsxs("div",{className:"space-y-8",children:[i.events.length>0&&e.jsxs("section",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-1 h-8 bg-gradient-to-b from-[var(--accent-purple)] to-[var(--accent-pink)] rounded-full"}),e.jsxs("h3",{className:"text-xl font-semibold text-[var(--text-primary)]",children:["🎭 ",s("navigation.events")]}),e.jsx("div",{className:"flex-1 h-px bg-[var(--border-color)]"}),e.jsxs("span",{className:"text-sm text-[var(--text-secondary)] bg-[var(--bg-secondary)] px-3 py-1 rounded-full",children:[i.events.length," ",s("search.items")]})]}),e.jsx("div",{className:"bg-[var(--bg-secondary)] rounded-xl p-6",children:e.jsx(k,{items:i.events,variant:c,showTags:!0,showDescription:c==="list",highlightText:a=>p(a,m),emptyMessage:s("events.noEventsFound"),filterType:"all"})})]}),i.exhibits.length>0&&e.jsxs("section",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-1 h-8 bg-gradient-to-b from-[var(--accent-blue)] to-[var(--accent-teal)] rounded-full"}),e.jsxs("h3",{className:"text-xl font-semibold text-[var(--text-primary)]",children:["🎨 ",s("exhibits.filters.exhibits")]}),e.jsx("div",{className:"flex-1 h-px bg-[var(--border-color)]"}),e.jsxs("span",{className:"text-sm text-[var(--text-secondary)] bg-[var(--bg-secondary)] px-3 py-1 rounded-full",children:[i.exhibits.length," ",s("search.items")]})]}),e.jsx("div",{className:"bg-[var(--bg-secondary)] rounded-xl p-6",children:e.jsx(k,{items:i.exhibits,variant:c,showTags:!0,showDescription:c==="list",highlightText:a=>p(a,m),emptyMessage:s("exhibits.noExhibits"),filterType:"all"})})]}),i.stalls.length>0&&e.jsxs("section",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-1 h-8 bg-gradient-to-b from-[var(--accent-orange)] to-[var(--accent-red)] rounded-full"}),e.jsxs("h3",{className:"text-xl font-semibold text-[var(--text-primary)]",children:["🍜 ",s("exhibits.filters.stalls")]}),e.jsx("div",{className:"flex-1 h-px bg-[var(--border-color)]"}),e.jsxs("span",{className:"text-sm text-[var(--text-secondary)] bg-[var(--bg-secondary)] px-3 py-1 rounded-full",children:[i.stalls.length," ",s("search.items")]})]}),e.jsx("div",{className:"bg-[var(--bg-secondary)] rounded-xl p-6",children:e.jsx(k,{items:i.stalls,variant:c,showTags:!0,showDescription:c==="list",highlightText:a=>p(a,m),emptyMessage:s("exhibits.noStalls"),filterType:"all"})})]})]})]})},se=()=>{const{searchQuery:m,setSearchQuery:v,performSearch:b}=D(),{t:s}=E(),x=W();return o.useEffect(()=>{const c=new URLSearchParams(x.search).get("q");c&&c!==m&&(v(c),b(c))},[x.search]),e.jsxs("div",{className:"min-h-screen bg-[var(--bg-primary)]",children:[e.jsxs("section",{className:"relative overflow-hidden py-16",children:[e.jsx("div",{className:"absolute inset-0 opacity-10",style:{background:"var(--instagram-gradient)"}}),e.jsx("div",{className:"relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-4xl md:text-5xl font-bold text-[var(--text-primary)] mb-4",children:s("search.title")}),e.jsx("p",{className:"text-xl text-[var(--text-secondary)] max-w-2xl mx-auto mb-8",children:s("search.subtitle")}),e.jsx("div",{className:"max-w-3xl mx-auto",children:e.jsx(J,{variant:"large",autoFocus:!0,showSuggestions:!0})}),e.jsx("div",{className:"max-w-2xl mx-auto mt-6",children:e.jsxs("div",{className:"bg-[var(--bg-secondary)] border border-[var(--border-color)] rounded-xl p-4",children:[e.jsxs("h3",{className:"text-sm font-semibold mb-3 text-[var(--text-primary)] flex items-center justify-center gap-2",children:[e.jsx("span",{children:"💡"}),s("search.searchTips")]}),e.jsxs("div",{className:"space-y-2 text-sm text-[var(--text-secondary)]",children:[e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-[var(--primary-color)]",children:"•"}),e.jsx("span",{children:s("search.searchInstructions.keyword")})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-[var(--primary-color)]",children:"•"}),e.jsx("span",{children:s("search.searchInstructions.tags")})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-[var(--primary-color)]",children:"•"}),e.jsx("span",{children:s("search.searchInstructions.location")})]})]})]})})]})})]}),e.jsx("section",{className:"section bg-[var(--bg-primary)]",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"space-y-8",children:[e.jsx(V,{compact:!1}),e.jsx("div",{className:"bg-[var(--bg-primary)] rounded-xl",children:e.jsx(X,{})})]})})})]})};export{se as default};
